https://doi.org/10.1099/mic.0.035188-0
Pan-genome analysis provides much higher strain typing resolution than multi-locus sequence typing Free
ABSTRACT The most widely used DNA-based method for bacterial strain typing, multi-locus sequence typing (MLST), lacks sufficient resolution to distinguish among many bacterial strains within a species. Here, we show that strain typing based on the presence or absence of distributed genes is able to resolve all completely sequenced genomes of six bacterial species. This was accomplished by the development of a clustering method, neighbour grouping, which is completely consistent with the lower-resolution MLST method, but provides far greater resolving power. Because the presence/absence of distributed genes can be determined by low-cost microarray analyses, it offers a practical, high-resolution alternative to MLST that could provide valuable diagnostic and prognostic information for pathogenic bacterial species.
Keywords ANI, average nucleotide identity, FDG, fraction of distributed genes, MLST, multi-locus sequence typing, NG, neighbour grouping, ST, sequence type
INTRODUCTION The risk of dying from infectious disease, even in first world countries, has a much higher heritability factor than that associated with any other type of disease, including heart attack and cancer (Sorensen et al., 1988). Moreover, even in the 21st century, epidemic infectious disease is responsible for more mortality and morbidity worldwide than all other disease states combined. In spite of this overwhelming burden to humankind and society, we are still not able to rapidly and accurately distinguish among the many strains and substrains of even the most common pathogenic agents. This is particularly true for many bacterial pathogens, due in part to the fact that they often evolve rapidly through either horizontal gene transfer mechanisms or their ability to rapidly produce a cloud of related organisms through the use of highly mutatable genes. Thus, there is an urgent need for improved molecular diagnostics to discriminate among the large numbers of related strains, and for better models for determining the relatedness among strains to aid in understanding the evolution and epidemiology of both established and emerging pathogens. Together, the development of these tools will aid prognosis, treatment and our ability to track epidemics.
Microbial epidemiologists track the spread of pathogens associated with disease in order to determine the sources of outbreaks and to understand their dynamics (Hall & Barlow, 2006; van Belkum et al., 2001). The ability to accurately characterize and follow epidemics is reliant on strain typing methods, sometimes called subtyping, to distinguish among isolates of the same species, and is usually accomplished using one or more DNA-based methods (Olive & Bean, 1999). The most widely used molecular strain typing method is multi-locus sequence typing (MLST), in which specific segments of seven or more housekeeping genes are sequenced. Each unique sequence of a locus is assigned an allele number, and an allele profile of a strain is defined as the set of allele numbers for that strain. Each unique allele profile is assigned a sequence type (ST) number. Strains that have the same ST number are identical at all of the sequenced loci and are considered to be members of the same clone because they cannot be distinguished from one another. At this time, there are 57 MLST schemes, representing 53 microbial species (http://pubmlst.org/databases.shtml). The MLST database spans a range from 12 798 isolates representing 7393 STs (Neisseria sp.) down to eight isolates representing eight STs (Campylobacter helveticus). MLST, unlike earlier molecular typing methods such as PFGE, is highly reproducible, is well suited for simple representation in databases and is relatively inexpensive.
Multiple outbreaks often result from infection by clonally related strains that are descended from a common ancestor and share biochemical and virulence properties. Understanding the dynamics of disease outbreaks requires estimating the relationships among isolates that are identified by strain typing; the most common approach to estimating those relationships is via phylogenetic analysis (Hall & Barlow, 2006; Olive & Bean, 1999).
Phylogenetic analysis is a means of estimating the evolutionary history of a set of taxa (species, genes, individuals etc) that are descended from a common ancestor and depends absolutely on the assumption that the taxa are genetically isolated from one another. When the taxon analysed is a species, the validity of that assumption is implicit in the definition of a biological species. Although it is well understood that there is some genetic exchange among microbial species, the amount of that exchange accounts for only a minor fraction of the variation between species, and molecular sequence-based phylogenetic trees of microbial species are generally robust.
Over the last several years, it has become apparent from MLST studies that many species, including Neisseria gonorrhoeae (O'Rourke & Spratt, 1994), Streptococcus pneumoniae (Feil et al., 2000), Streptococcus pyogenes (Feil & Spratt, 2001), Helicobacter pylori (Go et al., 1996) and Haemophilus influenzae (Meats et al., 2003), undergo considerable intra-species horizontal genetic exchange. In contrast, in Escherichia coli (Feil et al., 2001) and Staphylococcus aureus (Feil et al., 2003), genetic exchange was thought to be rare enough to be ignored for phylogenetic purposes, but a more recent study (Wirth et al., 2006) contradicts that view for E. coli. In a recent study, Perez-Losada et al. (2006) attempted to estimate the population recombination parameters from MLST data for 13 species, and concluded that H. pylori, N. gonorrhoeae and S. pneumoniae populations experience high levels of recombination but that Bacillus cereus, Haem. influenzae, Streptococcus agalactiae and S. pyogenes only experience moderate levels of recombination; however, Vibrio vulnificus, Campylobacter jejuni, Enterococcus faecium, E. coli, Staph. aureus and Moraxella catarrhalis experience low levels of recombination. Again, other studies have contradicted some of those assessments (Guttman & Dykhuizen, 1994; Hughes & Friedman, 2005; Wirth et al., 2006). The program ClonalFrame (Didelot & Falush, 2007) is reported to be able to extract sufficient phylogenetic signal from MLST data to permit estimation of phylogenetic relationships among some 58 isolates of various Bacillus species. That program is, however, computationally intensive and it is not clear that it would be practical to apply it to several hundred isolates of a single species.
Given the difficulty of assessing the extent of recombination within bacterial species, and in the absence of a clear understanding of how much recombination can be tolerated without obscuring meaningful phylogenetic signal, it is now well accepted that phylogenetic analysis is generally inappropriate for estimating relationships among isolates within a bacterial species.
The problem of taking recombination into account when assessing relationships within a species has led to an alternative method for estimating relationships from MLST data. Instead of trees, which seek to represent the historical relationships among all isolates on a single diagram, attention has turned to clustering methods that group together the most closely related strains. Such clustering meets the needs of microbial epidemiology for understanding the dynamics of disease outbreaks. One clustering method, the eBURST analysis (Feil et al., 2004), considers all MLST alleles to be equidistant from each other whether they differ by one or several nucleotides. As a consequence, recombination, which may introduce many substitutions from a single event, and mutation, which introduces a single substitution, are given equal weight. The eBURST method does not assume identity by descent; it only assumes, using identity by state, that two strains that share the same allele at several loci are more closely related than those that share the same allele at fewer loci. The word ‘related’ in this context does not imply descent from a common ancestor, and throughout this paper is simply used as a synonym for ‘genetically similar’. A strain is evaluated as being directly related to another strain only if the two are identical at all but one of the loci. A cluster of strains, each of which is directly related to at least one other strain in the cluster, is termed a clonal complex. Unlike a phylogenetic tree, which attempts to link all of the isolates using identity by descent, eBURST links isolates into separate clonal complexes that may consist of as few as two isolates and can leave some isolates unlinked to any clonal complex. Thus, a pair of isolates that differ by a single nucleotide at each of four of seven loci are considered unrelated, while another pair that differ by 4 nt at one of the seven loci are considered directly related. eBURST provides no estimate of the genetic distance between two clonal complexes or between unrelated isolates. eBURST is, however, a powerful and elegant way of representing relationships among fairly closely related isolates and is thus an important tool for microbial epidemiology.
The major limitation of MLST is its inability to resolve many isolates from each other. For instance, the Staph. aureus MLST database includes 2425 isolates that fall into 958 STs. However, 142 of those isolates are ST8 and thus are indistinguishable from each other, as are the 120 ST239 isolates. MLST involves sequencing portions of 7–10 housekeeping genes, and thus samples only about 0.1–0.2 % of a microbial genome, so it should not be terribly surprising that 142 isolates are identical when using that fraction of their genomes. The question is whether all, or many, of those isolates are actually different from each other. It seems likely that all ST8 isolates are not, in fact, identical and that higher resolution methods can usefully distinguish them from each other. We suggest that whole-genome information can provide that desired increase in resolution.
Comparisons of multiple whole-genome sequences of S. agalactiae (n=8) (Tettelin et al., 2005), Haem. influenzae (n=13) (Hogg et al., 2007) and S. pneumoniae (n=17) (Hiller et al., 2007) has led to the concepts of the ‘pan-genome’ and the distributed genome hypothesis (Ehrlich et al., 2005). More recent studies have extended the concept to E. coli (Willenbrock et al., 2007), Staph. aureus (Lindsay et al., 2006), S. pyogenes (Lefebure & Stanhope, 2007), and even to the set of all bacteria (Lapierre & Gogarten, 2009). For each of those species, there is a set of genes that are present in each member of the species (the core genes), and an additional set of genes that are present in some, but not all, members of the species (the distributed genes).
The core genes afford an opportunity to assess clonality on the basis of sequence differences among thousands of genes, rather than on the basis of differences among fragments of 7–10 genes. The distributed genes afford the opportunity to assess clonality on the basis of the presence or absence of individual distributed genes in each isolate.
In this study, we consider six bacterial species for which both extensive MLST databases and the complete genome sequences of at least 10 isolates exist. For each species, we ask whether multiple sequenced genomes have the same MLST sequence type, and if so, whether those MLST-identical strains can be resolved by either core gene or distributed gene differences. We propose a clustering method that permits estimating the relationships among isolates based on whole-genome information. Finally, we suggest a means by which sufficient information about distributed genes can be acquired with an ease and cost comparable to that of MLST to permit practical application of these findings to microbial epidemiology.
METHODS Accession numbers.The GenBank accession numbers of the complete genome sequences that were analysed in this study are given in Supplementary Table S1, available in Microbiology Online.
MLST analysis.For each species, the gene fragment sequences for each MLST locus were extracted from the genome sequences and the appropriate MLST website was used to identify the allele numbers of the locus sequences and the ST number. In some cases, allele numbers could not be assigned because of ambiguity codes in a sequence, and some novel alleles precluded assigning genomes to known STs. For the majority of genomes, however, sequence types could be assigned.
Analysis of pan-genomes.For each species, we identified orthologous genes by conducting blast (Altschul et al., 1990, 1997) searches of each sequence identified as a gene in the GenBank annotations against a database of all such genes. A set of Perl scripts was used to determine which sets of orthologues constituted core genes and distributed genes in all genomes. Genes were classified as orthologous if they shared at least 70 % nt sequence identity over at least 70 % of the length of the query sequence (Hogg et al., 2007). Genes that were present in each of the genomes were classified as core genes, while those that were present in at least one, but not all, genomes were classified as distributed genes.
The core gene distances between all possible pairs of genomes of each species were calculated by a Perl program, C-group, that used the blast program Blast2seq to calculate the nucleotide sequence identities between all possible pairs of each set of core orthologues. Those identities were averaged over all core genes and the distance between a pair of genomes was defined as 1−the average nucleotide identity (ANI) (Snel et al., 2005). A Perl program, S-group, was used to determine for each genome which distributed genes were present (scored as 1) and which were absent (scored as 0) in the genome. All possible pairs of genomes were compared and scored as 1 if a distributed gene was either present in both genomes or absent in each genome, and scored as 0 if the distributed gene was present in one genome but absent in the other genome. The scores for each of the distributed genes were summed and divided by the number of distributed genes to calculate the fraction of distributed genes (FDG) that were the same in both genomes. The distributed gene distance between the two genomes is 1−FDG (Hiller et al., 2007). Both distance measures are frequently used. A recent review discusses these and other measures of distance and similarity among genomes (Snel et al., 2005).
RESULTS MLST MLST-based analyses were able to resolve all 16 Salmonella enterica, all 11 S. pneumoniae and all 10 of the B. cereus strains that have been fully sequenced.
In contrast, of 14 sequenced Staph. aureus genomes, three strains (NCTC8325, USA300_FPR3757 and USA300_TCH1516) were ST8, three (Mu3, Mu50 and N315) were ST5, and two (JH1 and JH9) were ST105. It is perhaps not that surprising that there should be so many strains that cannot be distinguished by MLST among the 14 completely sequenced Staph. aureus genomes. There are 142 ST8, 137 ST5 and 41 ST105 isolates in the Staph. aureus database.
Similarly, among 22 E. coli genomes, three strains (APEC01, UT189 and S88) were ST95, two (O157 : H7_Sakai and O157 : H7_EC4115) were ST11 and two (MG1655 and W3110) were ST10. Among 12 S. pyogenes genomes, two (MGAS315 and SST-1) were ST15, two (MGAS9429 and MGAS2096) were ST36 and two (MGAS5005 and M1_GAS) were ST7.
The question, then, is whether pan-genome information using allelic data from all core genes or the presence/absence of distributed genes is able to resolve those strains that MLST cannot.
Properties of the pan-genomes Table 1T1 and Fig. 1F1 describe the detailed properties of the Staph. aureus pan-genome, while Table 2T2 summarizes the pan-genomes of E. coli, S. pyogenes, B. cereus, S. pneumoniae and Salm. enterica. These properties are consistent with earlier descriptions of the pan-genomes of these and other species (Hiller et al., 2007; Hogg et al., 2007; Lefebure & Stanhope, 2007; Lindsay et al., 2006; Tettelin et al., 2005; Willenbrock et al., 2007).
Resolution of genomes within a species by allelic analyses of core gene sequences Table 3T3 shows the core gene distances among the 14 Staph. aureus genomes. All genomes were resolved from each other, i.e. distances were >0, including those that could not be resolved by MLST. Notice that whereas the average distance between all genome pairs is 0.0073, the distance between genome pairs that could not be resolved by MLST is always ≤0.0002. Similarly, all 22 E. coli strains and all 12 S. pyogenes strains were resolved and, as was the case for Staph. aureus, the distances among genomes of the same ST were much smaller than the average distance among genomes. All 16 Salm. enterica strains, all 10 B. cereus strains and all 11 S. pneumoniae strains were likewise resolved. Tables of the core gene distance matrices, similar to Table 3T3, are given in Supplementary Tables S2–S13.
Neighbour grouping (NG) based on core gene distances We propose a clustering approach, NG, that, like eBURST, is based on identity by state but that is suitable for application to thousands of loci. The NG method is a variation on classical hierarchical clustering methods that use single linkage. The distances in Table 3T3 describe strictly differences of state. Those distance measures make no assumptions about whether the relatedness, in the sense of genetic similarity, is through identity by descent or whether it derives from recombination and/or horizontal gene transfer; they simply provide a metric of the degree of relatedness. While population biologists might have an interest in the historical relationships among groups of related isolates, for epidemiological purposes, it is sufficient to group isolates and perhaps to estimate whether or not any of the groups are related to each other. Note that we do not call such groups ‘clonal complexes’ because clonality implies identity by descent.
Based upon core gene sequence identity, the mean distance among Staph. aureus core genomes is 0.00733±0.00042 (Table 3T3). NG defines a pair of genomes as valid neighbours if they are significantly more closely related than the average pair of genomes; in the case of Staph. aureus, if their distance is less than 0.00691. On that basis, neither RF122 nor MRSA252 has a valid neighbour. A pair of strains are assigned to the same group if they are nearest neighbours of each other. As subsequent strains are sequentially considered, one is assigned to a group only if it is the nearest neighbour of a member of that group, thus all members of a group are nearest neighbours of at least one other genome in that group. On that basis, there are seven groups: group 1, RF122; group 2, COL, Newman; group 3, JH1, JH9; group 4, MRSA252; group 5, MSSA476, MW2; group 6, Mu3, Mu50, N315; and group 7, NCTC8325, USA300_FPR3757, USA300_TCH1516.
We further define a pair of groups as related if at least one member of a group has at least one valid neighbour in the other group. On that basis, group 2 is related to groups 3, 5, 6 and 7; thus, groups 2, 3, 5, 6 and 7 form a complex, but groups 1 and 4 are not related either to that complex or to each other (Fig. 2aF2).
Supplementary Tables S4–S13 give details of the groupings for E. coli, S. pyogenes, B. cereus, S. pneumoniae and Salm. enterica, and the groupings for each of the six species are summarized in Table 4T4.
NG based on core gene sequence differences clusters strains in a way that is consistent with eBURST clustering of MLST data for the same strains, while permitting far greater resolution among strains than that provided by MLST. NG also permits estimation of deeper relationships than eBURST analysis, by clustering related groups into complexes. Despite the higher resolution afforded by analysis of core gene sequences, the cost, time and effort required for whole genome sequencing precludes practical application of this approach to microbial epidemiology.
NG based on the presence or absence of distributed genes While it is both expensive and time consuming to determine the sequences of the core genes of a strain, it is relatively inexpensive and quick to determine the presence or absence of each of the distributed genes in the pan-genome of a species by performing comparative genome hybridization to microarrays imprinted with each of the distributed genes. Thus, we determined for each of the six species identified above, whether the presence or absence of distributed genes provides as much resolution among strains as core gene sequences and, if so, whether clustering by NG based on distributed genes is consistent with both MLST clustering by eBURST and with NG clustering based on core gene sequences.
Table 3T3 also shows the distributed gene distances for Staph. aureus. These were calculated on the basis of the presence or absence of each of the distributed genes from the Staph. aureus pan-genome in each genome. The distance between two genomes is defined as the fraction of distributed genes from the pan-genome in which the two genomes differ with respect to the presence or absence of a distributed gene. Thus, for Staph. aureus, whose pan-genome includes 2298 distributed genes, a pair of strains that differ in the presence/absence of 150 distributed genes would have a distance of 0.065.
Table 3T3 shows that all 14 Staph. aureus genomes were resolved on the basis of distributed gene distances. The NG groups are very similar to those estimated on the basis of core gene sequences and are consistent with MLST eBURST clustering. There are five groups: group 1, RF122; group 2, COL, USA300_FPR3757, NCTC8325, USA300_TCH1516, Newman; group 3, JH1, JH9; group 4, MRSA252, N315, Mu3, Mu50; and group 5, MSSA476, MW2. The differences between clustering on the basis of core gene sequences and on the basis of the presence or absence of distributed genes is that the latter combines the core gene groups 2 and 7 into a single group and it includes MRSA252 in the group with N315, Mu3 and Mu50. Groups 2–5 are linked into a single complex (Fig. 2bF2). Similarly, all genomes of the other five species under consideration were resolved by distributed gene distances (Supplementary Tables S2–S13).
In an NG analysis, each pair of genomes has one of two relationships: they are in the same group or they are in different groups. Two groupings can be compared to determine what fraction of the relationships are the same in the two analyses. That fraction is the similarity of the groupings. For Staph. aureus, the grouping similarity was 0.857. Table 4T4 shows the core and distributed gene groupings, and the similarities of those groupings for all six species.
DISCUSSION Whole genome sequences provide two distinct ways to distinguish, or type, strains within a species: on the basis of core gene similarities and on the basis of the presence or absence of distributed genes. Both approaches sample an enormously greater proportion of the genome than MLST. Core genes sample a greater fraction of the genome (56 % for E. coli and 72 % for Staph. aureus) than do distributed genes, but the degree of variation among the core genomes is much less than in the smaller fraction of the genome sampled by distributed genes. For instance, Staph. aureus strains JH1 and JH9 differ at 10−5 of the bases, or about 20 bp, in their core genes, but they differ at 0.0553 of the distributed genes in the Staph. aureus pan-genome, i.e. in the presence or absence of 125 genes. Similarly, E. coli K-12 strains MG1655 and W3110 differ at only 1.23×10−6 of the base pairs in their 2610 core genes, or at about 4 bp, but they differ in the presence of 0.0195 of the 10 489 distributed genes in the E. coli pan-genome, i.e. in 205 distributed genes. Thus, microarrays imprinted with all of the genes from a species' distributed genome (Tettelin et al., 2005; Ehrlich et al., 2005; Hogg et al., 2007; Hiller et al., 2007) can be used to obtain accurate typing information that can be used in clinical diagnostics and for epidemiological studies. This type of approach was used when the data from a seven strain Staph. aureus pan-genome was used to build a microarray to estimate a phylogenetic tree of 161 Staph. aureus strains (Lindsay et al., 2006), and a similar study has been conducted in E. coli (Willenbrock et al., 2007). The distributed genes of both species, some 10–15 % of which are associated with extra-chromosomal elements, suggest considerable recombination, thus we doubt that there is sufficient phylogenetic signal to permit estimating a valid phylogenetic tree of either species. Of course, phylogenetic software will estimate phylogenetic trees whether or not those trees are valid. Nevertheless, both studies indicate that isolates can be distinguished on the basis of the presence or absence of genes.
It might be argued that such a high level of strain typing resolution is not only unnecessary but also counter productive. According to that view, perfect resolution (each strain is distinct) is equally as uninformative as zero resolution. That would be true only if we could not estimate the relationships among those ‘perfectly resolved’ isolates. The NG clustering method provides a convenient and reasonable way to estimate those relationships and allows high-level typing resolution to be useful.
NG provides an alternative to phylogenetic analysis that, like MLST and eBURST analysis, depends not on identity by descent but only upon identity by state (genome similarity) for estimating relationships among strains. Because NG samples a much higher fraction of the genome than MLST, it provides much better resolution than MLST. Comparing the NG method based on core genes alleles to MLST, it is hardly surprising that the complete sequences of thousands of genes resolve strains that are irresolvable by the partial sequences of seven genes. It might be argued that the resolution achieved from the sequences of core genes is almost too high. For instance, the E. coli K12 strains MG1655 and W3110 differ at only 1.23×10−6 of the bases in their core genes; i.e. at only about 4 bases among those genes. Indeed, in private conversations, some have argued that two strains that are that similar should be considered, for epidemiological purposes, to be members of the same clone. However, our distributed gene-based NG analyses show that these strains are significantly different on a gene possession basis, therefore, it is likely that if the core NG method finds a difference, it is real and important clinically and epidemiologically. Thus, with the high resolution that comes with whole genome analyses, it is essential to have a clustering method available that shows which strains are most closely related to each other and how close those relationships are.
Our study of six bacterial species shows that core gene sequences provide much higher resolution than MLST, in all cases distinguishing among strains that have the same MLST ST. NG analyses are entirely consistent with MLST clustering by eBURST, yet they provide additional discriminatory power. Despite the rapid development in DNA sequencing technologies, whole-genome sequencing remains far too costly to be used in routine epidemiological studies or in many academic studies of microbial population structure. For that reason, strain typing and estimating relatedness based on core gene sequences is not yet practical. However, it is both practical and cost effective to use comparative genome hybridization to microarrays of distributed gene probes both to type strains and to estimate relationships among strains by the NG method. Our results show that for all six species, strain typing by the presence or absence of distributed genes affords even higher resolution than typing by sequencing the core genes.
NG by distributed genes is completely consistent with MLST grouping by eBURST, and is also highly consistent with NG by core gene sequences (Table 4T4). If a pair of strains that differ at only 4 bp can be distinguished by the presence or absence of 205 distributed genes, it seems likely that distributed gene microarrays will be able to distinguish virtually all isolates. At this time, the only advantages of MLST are lower cost and the large number of strains in some MLST databases. When distributed gene arrays are widely available, cost is likely to decrease dramatically, and strain typing on the basis of pan-genome distributed genes will offer a high-resolution alternative to MLST and other DNA-based typing methods; as the databases of distributed gene types strains grow, their value will surpass that of MLST for epidemiological purposes. It is our hope, indeed our expectation, that as large numbers of strains are analysed by distributed gene arrays, correlations will be found between the presence/absence of certain genes and clinically important phenotypes such as virulence and antibiotic resistance etc. Determination of those correlations is expected to permit development of specialized microarrays that can assess many phenotypes simultaneously and inexpensively.
A supplementary table of the GenBank accession numbers of strains analysed in this study and 13 supplementary tables of the core and distributed gene distances and groupings for Staphylococcus aureus, Escherichia coli, Bacillus cereus, Streptococcus pyogenes, Salmonella enterica and Streptococcus pneumoniae are available with the online version of this paper.