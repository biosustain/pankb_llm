https://doi.org/10.1093/gbe/evt002
Gene Frequency Distributions Reject a Neutral Model of Genome Evolution
Abstract Evolution of prokaryotes involves extensive loss and gain of genes, which lead to substantial differences in the gene repertoires even among closely related organisms. Through a wide range of phylogenetic depths, gene frequency distributions in prokaryotic pangenomes bear a characteristic, asymmetrical U-shape, with a core of (nearly) universal genes, a “shell” of moderately common genes, and a “cloud” of rare genes. We employ mathematical modeling to investigate evolutionary processes that might underlie this universal pattern. Gene frequency distributions for almost 400 groups of 10 bacterial or archaeal species each over a broad range of evolutionary distances were fit to steady-state, infinite allele models based on the distribution of gene replacement rates and the phylogenetic tree relating the species in each group. The fits of the theoretical frequency distributions to the empirical ones yield model parameters and estimates of the goodness of fit. Using the Akaike Information Criterion, we show that the neutral model of genome evolution, with the same replacement rate for all genes, can be confidently rejected. Of the three tested models with purifying selection, the one in which the distribution of replacement rates is derived from a stochastic population model with additive per-gene fitness yields the best fits to the data. The selection strength estimated from the fits declines with evolutionary divergence while staying well outside the neutral regime. These findings indicate that, unlike some other universal distributions of genomic variables, for example, the distribution of paralogous gene family membership, the gene frequency distribution is substantially affected by selection.
Introduction Comparative genomics of prokaryotes (archaea and bacteria) provides compelling evidence that the genomes of these organisms are in incessant flux (Snel et al. 2002; Dagan et al. 2008; Koonin and Wolf 2008). Through common and intensive processes of gene loss and gene gain via horizontal gene transfer, gene repertoires of prokaryotes typically diverge rapidly, much faster than the sequences of highly conserved genes that are traditionally used for phylogeny construction, such as ribosomal RNA or ribosomal proteins (Snel et al. 2002; Kunin and Ouzounis 2003; Mirkin et al. 2003; Dagan et al. 2008). As a result, even prokaryotes with (nearly) identical sequences of conserved genes that are classified as strains of the same species often substantially differ in their gene repertoires (Akopyants et al. 1998; Lawrence and Hendrickson 2005; Medini et al. 2005; Kettler et al. 2007; Rasko et al. 2008; Tettelin et al. 2008; Ishmael et al. 2009; Reno et al. 2009; Touchon et al. 2009; den Bakker et al. 2010; Mira et al. 2010). The first to be discovered and by now textbook case of such major interstrain differences involves laboratory and pathogenic strains of Escherichia coli that may differ by as many as 30% of their genes due to the acquisition of so-called pathogenicity islands by the pathogenic strains (Perna et al. 2001; Kudva et al. 2002; Zhang et al. 2007).
At the other end of the spectrum, when genomes of distant prokaryotes, for example, archaea and bacteria, are compared, the fraction of readily identifiable orthologous genes is a small minority of the respective gene sets (Koonin and Wolf 2008). The core set of universally conserved genes is tiny, less than 100, and slowly but steadily shrinking with the growth of the number of sequenced genomes (Koonin 2003; Charlebois and Doolittle 2004; Puigbò et al. 2009).
Collectively, these findings on the fluidity of the prokaryotic gene repertoires led to the concept of pangenome, which may be defined as the totality of the genes found in a particular clade and is sometimes viewed as a new paradigm in microbial genomics (Tetz 2005; Rasko et al. 2008; Mira et al. 2010; Karberg et al. 2011).
Pangenomes can be defined at any phylogenetic depth, from all prokaryotes to strains of a single species or even isolates of a single strain. The diversity of gene repertoires can be quantitatively summarized in a gene frequency distribution, that is, the probability ck that a randomly picked gene is found in precisely k out of K genomes (Baumdicker et al. 2010; Collins and Higgs 2012). Remarkably, the gene frequency distribution shows a characteristic asymmetric U-shape regardless of the phylogenetic depth at which a pangenome is analyzed (Koonin 2011b). All gene frequency distributions consist of a core of common genes (cK), numerous unique genes (c1), and relatively underpopulated intermediate classes (Koonin and Wolf 2008; Touchon et al. 2009).
The gene frequency distribution contains information about the evolutionary mechanisms that shape the gene repertoire of each individual (Medini et al. 2008). Haegeman and Weitz (2012) implemented a population dynamic model that combined birth-and-death processes with additional terms for gene loss and gain and found that this model reproduced the U-shaped gene frequency distribution within a single population sufficiently well to conclude this distribution could result from purely neutral processes. Another neutral evolutionary model, which the authors denoted the Infinite Genes Model (IMG), has been recently introduced to explain the gene frequency distribution (Baumdicker et al. 2010, 2012; Collins and Higgs 2012). In this model, organisms are considered to be “bags of genes” that evolve along a tree. Genes are deleted and acquired at random (hence the neutrality), and when a new gene is acquired, its identity is novel (hence infinite genes). Several versions of the IMG have been examined depending on whether there are essential genes that cannot be lost, the number of categories of dispensable genes, and whether evolution is considered on a fixed tree or on an ensemble of random coalescents. Collins and Higgs (2012) concluded that using the fixed phylogenetic tree is essential for a good fit. In addition, to obtain a reasonable fit, they had to include two classes of dispensable genes and essential genes into the model resulting in a 5-parameter fit. Baumdicker et al. (2012) also recognized the importance of the correct phylogenetic tree. In addition, a formal test of neutrality with correction for sampling bias was applied to the analyzed data set, which included two small groups of closely related bacteria. Contrary to the conclusions of Haegeman and Weitz, Baumdicker et al. concluded that the neutral model could be rejected. In each of these studies, the gene frequency distributions were analyzed only for a handful of bacterial groups.
Here, we undertake to expand the analysis of the gene frequency distributions to a large number of groups of prokaryotes that span a wide range of evolutionary distances. We introduce the stationary genome on a tree (SGT) framework, which allows us to fit empirical gene frequency distributions with fewer parameters than the IMG models yet provides more flexibility in the choice of models with selection. By comparing the goodness of fit to the empirical distributions for different models, we show that the neutral model can be confidently rejected and that the SGT framework is sufficiently rich to distinguish between increasingly complex models with selection.
Results Models of Genome Evolution In the SGT framework, organisms evolve along a tree, and their genome size is fixed. We justify this assumption by exploring a stochastic population model with gene deletion and innovation (see supplementary information, Supplementary Material online), which indicated that the genome size fluctuations are small for a broad range of parameters. The genes are placed to genomic slots each with an associated turnover rate. When a gene is turned over in a slot, it is replaced by a gene with a novel identity. In this respect, the SGT is similar to the IMG. The genomic slots can have an arbitrary distribution of turnover rates. We investigated four models of evolution within the SGT framework. In the neutral model (model A), nothing differentiates the genes, and all slots have the same turnover rate, that is, the distribution of turnover rates is a delta function. When selection is important and the intrinsic gene deletion rate is uniform among all genes, genes that confer a greater fitness advantage are lost from the population at a lower rate. Therefore, the models in which slots turn over at different rates are labeled as models with selection in this study. In the two-parameter model B, the rates are gamma distributed. The scale parameter of the Gamma distribution sets the overall evolutionary rate, whereas the shape parameter controls the strength of selection. A large shape parameter results in a sharply peaked distribution of turnover rates and therefore signifies weak selection. In model C, just as in Collins and Higgs (2012), there are two classes of genes: slow and fast evolving. Thus, model C has three fitting parameters: the rates of replacement for the slow-evolving genes and fast-evolving genes and the fraction of the genome that is assigned to the slowly evolving genes. Unlike models A, B, and C, in which the distribution of turnover rates is parametrized, in model D, this distribution derives from a stochastic population model described in detail in the Materials and Methods section. Model D has two parameters: first, the ratio of population size to the genome size, which reflects the strength of selection, and second, the rate of evolution.
The models were tested on a data set comprised approximately 400 groups of 10 prokaryotes spanning a wide range of evolutionary distances (see Materials and Methods for the details of the group formation). The empirical gene frequency distribution was computed for each group (see Materials and Methods for details), the frequency distributions derived from each of the four models were fit to each of the empirical distributions, and the goodness of fit was compared using the Akaike Information Criterion (AIC) (see Materials and Methods). Because the data set includes the total of 784 species, there were significant overlaps between the groups. Although the different groups were generally not independent from each other, the conclusions reached for the complete data set did not change qualitatively when the analysis was repeated with a reduced data set, which contained 17 nonoverlapping groups of closely related species (see supplementary information, Supplementary Material online).
Fit of Evolutionary Models to the Empirical Gene Frequency Distributions Before discussing the fitting of the models to the data, we examine the variation of the empirical gene frequencies with evolutionary divergence. Figure 1 shows the frequencies c1 of unique and c10 of strictly common genes as a function of the mean tip to root branch length. Each point in figure 1 corresponds to one of the 400 groups or species. Predictably, the frequency of unique genes increases, whereas the frequency of common genes drops with the evolutionary distance; both dependencies are roughly linear. Notably, however, the frequency of common genes does not approach unity as the mean evolutionary distance tends to zero. It appears that different isolates of the same species (or even strain) can have as little as 70% of the genes in common. This observation reflects the known fact that closely related bacterial isolates can differ by as much as 30% of their gene sets, in particular due to acquisition of pathogenicity islands (Perna et al. 2001; Kudva et al. 2002; Zhang et al. 2007).
The gene frequency distributions produced by each of the four models were fit to the empirical distributions using a procedure described in the Materials and Methods. Figure 2 shows the gene frequency distributions and the corresponding model fits for four representative groups of prokaryotes spanning the range of evolutionary divergence analyzed in this work. Clearly, the neutral model (A) yields a substantially inferior fit to the observed gene frequencies compared to the models with selection. The distinction between the models is qualitative rather than only quantitative: unlike each of the models with selection, the neutral models fails to reproduce the U-shaped distribution yielding instead a peak at one of the intermediate gene frequency classes (fig. 2). A quantitative comparison of the fits using in the AIC shows that the difference between the models with selection and the neutral model is highly statistically significant (fig. 3 and table 1). The likelihood that model B fits the data better than model A, for example, is the exponential of the half of the difference in the respective AICs (Akaike 1974), that is, a difference of 10 in the AIC translates to a P value of forumla⁠. The three models with selection differed from each other much less than each of them differed from the neutral model, but, nevertheless, model D on average yielded a significantly better fit that models B and C (fig. 3 and table 1).
Each of the three models with selection included a parameter that reflected selection strength: the inverse shape parameter in model B, the fraction of slowly evolving genes in model C, and the ratio of the population size to the genome size in model D (see Materials and Methods for details). The replacement rate distributions in models B and D are more sharply peaked when selection is weaker. In model C, selection strength is reflected in the fraction of the genome that evolves under stronger selection and therefore has a lower replacement rate. Figure 4 shows the dependence of the estimated selection strength on the evolutionary distance. Perhaps counterintuitively, the selection pressure consistently and sharply declines with divergence under each of the three models. The selection pressure translates into the breadth of the distribution of the gene turnover rates. Weaker selection implies a more peaked distribution of turnover rates with diminished contributions from both the high and the low turnover rates. The dearth of high turnover rates at longer evolutionary distances may be explained by the fact that multiple turnovers in the same slot on the same branch of a tree are undetectable. Thus, the highest detectable turnover rate is set by the shortest branch in the tree. Conversely, for groups of closely related organisms, there might have not been enough time to experience replacements of many genes. The weight of the low turnover rate tail of the distribution may therefore be overestimated in closely related groups. These two factors that probably lead to the observed decrease in the contribution of selection to the observed gene frequency distributions with evolutionary distance effectively stem from the simplifying assumptions of the employed models of evolution (made to ensure model tractability). However, it is also possible that with the increasing divergence of genomes, gene replacements increasingly involve metabolic, signal transduction, and other gene modules, so that selection becomes relevant only for the conservation of the core genes that largely encode components of information processing systems.
All models include a parameter that reflects the characteristic gene replacement rate. If the gene repertoires of prokaryotes are shaped by the same mechanisms throughout the range of evolutionary divergences and if the SGT model captures these mechanisms, the gene turnover rate should be independent of the mean branch length from tip to root. Figure 5 shows the estimated turnover rates in model C (the evolutionary rate parameter in other models tracks that of model C closely up to a multiplicative factor) measured in gene turnovers per substitution-per-site. The rates are roughly independent of the mean branch length for moderate to large divergences. The slowly evolving genes are replaced on average once for every 10 substitutions per site, whereas the quickly evolving genes turn over when a single substitution per site on average has been accumulated. The sharp increase in the estimated rates at the shortest evolutionary distance apparently indicates that some of the SGT assumptions break down in this distance range. A possible explanation for the spike in the estimated evolutionary rate might be the greater contribution of gene transfer processes that affect multiple genes at a time, such as transfer of pathogenicity and symbiosis islands at short evolutionary distances (Groisman and Ochman 1996; Juhas et al. 2009).
Discussion The nontrivial, asymmetrical U-shape of the gene frequency distribution that is observed in prokaryotic pangenomes through a broad range of phylogenetic depths calls for an explanation that arguably would come in the form of a maximally realistic yet tractable model of evolution. Evolutionary genomics and evolutionary systems biology yielded universal distributions of several biologically important quantities and attempts have been made to explain (that is reproduce) these distributions via models of evolution that are either neutral or include various forms of selection (Koonin 2011a). For example, the power law distribution of the size of paralogous families that has essentially the same shape for all available genomes is well approximated with birth–death innovation without selection (Huynen and van Nimwegen 1998; Karev et al. 2002; Koonin et al. 2002). Similar nonadaptive models have been invoked to explain the evolution of genetic networks (Lynch 2007b). In contrast, the universal log-normal distribution of evolutionary rates of orthologous genes seems to require purifying selection as an intrinsic component of the underlying evolutionary model (Lobkovsky et al. 2010). A recent study has suggested that a neutral model might be sufficient to explain the U-shape of the gene frequency distribution (Collins and Higgs 2012), whereas an analysis based on a different underlying model led to the rejection of the neutral model (Baumdicker et al. 2012). Each of these analyses involved a small sample of bacteria and required a moderately large number of parameters for a reasonable fit putting the generality of the conclusions into question.
We sought to investigate whether selection is required to explain the observed shape of the gene frequency distributions by analyzing a large sample of bacterial and archaeal groups that span a wide range of evolutionary divergence. To model genome evolution, we developed the SGT framework. The key assumption of the SGT is that the genome is in steady state throughout evolution. This assumption translates in practice into the fixed genome size and distribution of gene turnover rates. The fixed genome size assumption is certainly a simplification but, given the relatively narrow, sharply peaked distributions of bacterial and archaeal genome sizes (Koonin and Wolf 2008; Koonin 2011b), assuming stationary genomes on the evolutionary scale appears to be realistic. In addition, the results of a stochastic population model with gene duplication and deletion suggest that the genome size fluctuations are small in a broad parameter range.
The SGT framework is flexible because it admits an arbitrary distribution of gene replacement rates. The breadth of this distribution reflects the selection pressure that constrains the underlying evolutionary processes ultimately responsible for gene turnover. We compared the fits of the empirical gene frequency distributions for 400 groups of bacteria and archaea to the neutral model, in which all genes have the same turnover rate, to the fits produced by three other models with selection. The goodness of fit measured by the AIC indicates that the neutral model does not account for the observed gene frequency histograms nearly as well as the models with selection. Moreover, the difference between the neutral model and the models that incorporate selection is qualitative: the neutral model fails to mimic the U-shaped gene frequency distribution yielding no core of highly conserved genes. Among the three examined models with selection, the best fit on average resulted from using the distribution of gene turnover rates produced by stochastic population dynamics with additive per-gene fitness effects in which the fixation of mutant genes was considered explicitly. Although this model is the most complicated and arguably most realistic of the three models with selection, it is still oversimplified (even apart from the general SGT assumptions) because it ignores intergenic epistasis, undoubtedly an important aspect of evolution (Phillips 2008). A more detailed examination of the model D fit to the empirical gene frequency distributions shows that the model systematically overestimates the fraction of rare genes and underestimates the fraction of the common genes (fig. 6). This effect could result from the underestimation of the selection strength. The positive intergenic epistasis ignored by the additive fitness assumption could render the selective coefficient for a group of genes greater than the sum of the selective coefficients of the constituent individual genes.
The model fits yield information about the effective selection pressure that is responsible for the observed gene frequency distribution. We found a sharp decline of the selection strength with evolutionary distance, which manifested in the sharper peaked, more narrow distributions of replacement rates for groups of organisms with high mean divergence. We suggest that narrowing of the estimated distribution of replacement rates—and accordingly diminished selection with divergence—is at least in part due to two limitations of comparative genome analysis. First, the weight of low replacement rates is overestimated in closely related groups and second, the high replacement rates cannot be measured in divergent groups. However, these limitations notwithstanding, it cannot be ruled out that at large evolutionary distances, when entire gene modules are replaced in the compared organisms, selection is evident only for small cores of highly conserved, essential genes, primarily those involved in genomic information processing.
Fitting the gene frequencies in model D to the empirical gene frequencies yields estimates of the ratios of the population size to the genome size. The best fits translate to effective population sizes of forumla⁠. The population sizes that are measured for bacteria typically are at least an order of magnitude larger (Lynch 2006). However, the small effective population size that emerges as the best fit in our models of genome evolution might reflect the substantial evolutionary effect of population bottlenecks (Lynch 2007a).
The characteristic rate of evolution yielded by the explored models with selection is roughly constant over a large portion of the range of evolutionary divergence. This observation implies that the SGT assumptions could be reasonable in that range. However, the extracted rates of evolution exhibit a large spike at short evolutionary distances, possibly due to horizontal transfer of large genomic segments including many genes. For this range of evolutionary distances, a modified approach to evolutionary modeling is probably required.
The main conclusion of this work is that selection made a substantial contribution to the mechanisms that shaped the universal gene frequency distribution in prokaryotes. Certainly, it would be unreasonable to question the existence of selection affecting genes responsible for key biological functions. However, it was far from obvious whether the effect of selection and its strength could be detected and measured at the level of the overall frequency distribution, without turning to individual genes. We believe that the present results solve this problem by demonstrating that a neutral model fails to explain the existence of the conserved gene core and moreover that models with different implementations of selection could be readily distinguished.