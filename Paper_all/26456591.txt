https://doi.org/10.1016/j.ygeno.2015.10.001
Title: PanCoreGen - Profiling, detecting, annotating protein-coding genes in microbial genomes
Abstract: A large amount of genomic data, especially from multiple isolates of a single species, has opened new vistas for microbial genomics analysis. Analyzing the pan-genome (i.e. the sum of genetic repertoire) of microbial species is crucial in understanding the dynamics of molecular evolution, where virulence evolution is of major interest. Here we present PanCoreGen — a standalone application for pan- and core-genomic profiling of microbial protein-coding genes. PanCoreGen overcomes key limitations of the existing pan-genomic analysis tools, and develops an integrated annotation-structure for a species-specific pan-genomic profile. It provides important new features for annotating draft genomes/contigs and detecting unidentified genes in annotated genomes. It also generates user-defined group-specific datasets within the pan-genome. Interestingly, analyzing an example-set of
Salmonella genomes, we detect potential footprints of adaptive convergence of horizontally transferred genes in two human-restricted pathogenic serovars — Typhi and Paratyphi A. Overall, PanCoreGen represents a state-of-the-art tool for microbial phylogenomics and pathogenomics study.
Introduction The pan-genome of a species is the sum of non-redundant genomic regions from its representative genomes. It is composed of core genomic regions present in all genomes, and accessory regions found in one or more, but not in all genomes. Pan-genomic profiling at diverse taxonomic levels, ranging from within-clonal or within-species population structure to cross-species metagenomics, offers a pivotal role in detecting evolutionary footprints, the pathoadaptive ones being of special importance [1–4] .
The exponential increase in genomic data, especially from multiple isolates of a single microbial species has opened new vistas for microbial genomic analysis. Therefore, an important focus is now to develop fine-tuned tools to analyze large amounts of genomic information. Pan-genomic analysis across multiple microbial genomes has great potential for understanding the evolution and mechanisms of virulence [5–9] . The protein coding genes in core genomic fractions are crucial for the study of phylogenomics as well as for the understanding of the roles of mutation and recombination in the evolution of functional traits, especially with regard to virulence [10–12] . The mosaic genes, in contrast, primarily depict the contribution of horizontal gene transfer in (patho-)adaptive evolution. Frequently, the position of such genes in genomic islands is exclusive to a specific group (e.g. pathotype, serotype or phylogenetic clade) within the species and these genes encode traits associated with increased pathogenicity, antibiotic resistance, etc. [13–15] . Therefore, a user-friendly tool for pan-genomic analysis of microbial genomes is much needed.
Presently, for microbial pan-genomic analysis, there are a number of well-accepted tools available, such as Panseq [16] , PGAT [17] and PGAP [18] . Although these tools offer effective approaches in extracting the core and mosaic genomic regions, there are some important limitations. Panseq and PGAT are entirely web-based without any standalone version. Both tools restrict the analysis to organisms in their server databases and offer limited allowance of additional genome sequences of these organisms as external input. Panseq divides genomes using user-defined length thresholds based on which it extracts core and mosaic genomic segments, without any information on genes. Although PGAT and PGAP identify orthologous clusters of genes and proteins respectively, both approaches compare only annotated genes/proteins, inhibiting any detection of new genes that remain unidentified (not annotated) in otherwise annotated genomes. Moreover, the orthologous genes detected by PGAP are listed without direct access to the sequences of respective genes for further analysis.
Here we present PanCoreGen, a new tool that generates pan-genomic profiles of genes, resolving most of the existing shortcomings. In contrast to the existing tools, PanCoreGen is a standalone software with graphic user interface offering an array of functionalities — (i) direct download of genome sequences from GenBank, (ii) pan-/core-genomic profiles across the entire sample set, (iii) similar profiles within user-defined strain-groups, (iv) annotations of user-provided draft genomes, and (v) detection of unidentified genes in annotated genomes ( Fig. 1 ). Based on user-defined threshold values of nucleotide-identity and length-coverage, this tool distinguishes each gene as core (i.e. present in all genomes of the sample set), mosaic (i.e. present in multiple but not all genomes), or genome-specific (i.e. present only in one of the annotated genomes) ( Supplementary Fig. 1 A). To build the pan-genomic database of orthologous genes, PanCoreGen performs BLASTN (for nucleotide) against genes from each annotated genome to detect orthologs in the rest of the genomes. This algorithm provides information on a gene previously unidentified in an annotated genome. Importantly, such an approach offers annotation of draft genomes or contigs based on all unique annotated genes present in the sample set. Also, to understand the evolution of virulence in a specific pathotype or group of strains in a given species (e.g. extra-intestinal pathogenic E. coli , Shigella , human-restricted systemically invasive serovars of Salmonella , etc.), one crucial need is to extract the pan- and core-genomic information within that group [8,19,20] . PanCoreGen generates all such profiles for user-defined groups. In addition, our tool outputs a sequence dataset for each gene, incorporating genomic location information on orthologs in each genome. This allows users to study genes of interest for the analysis of sequence diversity, detection of positive selection footprints, etc. The functionalities of PanCoreGen are outlined in Fig. 1 .
Here we present PanCoreGen, a new tool that generates pan-genomic profiles of genes, resolving most of the existing shortcomings. In contrast to the existing tools, PanCoreGen is a standalone software with graphic user interface offering an array of functionalities — (i) direct download of genome sequences from GenBank, (ii) pan-/core-genomic profiles across the entire sample set, (iii) similar profiles within user-defined strain-groups, (iv) annotations of user-provided draft genomes, and (v) detection of unidentified genes in annotated genomes ( Fig. 1 ). Based on user-defined threshold values of nucleotide-identity and length-coverage, this tool distinguishes each gene as core (i.e. present in all genomes of the sample set), mosaic (i.e. present in multiple but not all genomes), or genome-specific (i.e. present only in one of the annotated genomes) (Supplementary Fig. 1A). To build the pan-genomic database of orthologous genes, PanCoreGen performs BLASTN (for nucleotide) against genes from each annotated genome to detect orthologs in the rest of the genomes. This algorithm provides information on a gene previously unidentified in an annotated genome. Importantly, such an approach offers annotation of draft genomes or contigs based on all unique annotated genes present in the sample set. Also, to understand the evolution of virulence in a specific pathotype or group of strains in a given species (e.g. extra-intestinal pathogenic E. coli , Shigella , human-restricted systemically invasive serovars of Salmonella , etc.), one crucial need is to extract the pan- and core-genomic information within that group [8,19,20] . PanCoreGen generates all such profiles for user-defined groups. In addition, our tool outputs a sequence dataset for each gene, incorporating genomic location information on orthologs in each genome. This allows users to study genes of interest for the analysis of sequence diversity, detection of positive selection footprints, etc. The functionalities of PanCoreGen are outlined in Fig. 1 .
The PanCoreGen program can be freely obtained as PanCoreGen_installer.exe from https://sourceforge.net/projects/pancoregen1/ . The installer includes PCG.exe (the user interface), script.exe (the main program), makeblastdb.exe (the program to format genome sequences for BLAST), blastn.exe (the program for standalone BLAST operations), Documentation.pdf (the documentation file) and a ‘Sample_input’ folder (containing the sample genome files).
Results and discussion Program approach To construct the pan-genomic profile as robustly as possible, PanCoreGen utilizes gene-annotations of each annotated genome as reference (in the order provided by the user). Genes of such an annotated pan-genome, in essence, serves as reference both for the identification of unidentified genes in annotated genomes and for the annotation of any un-annotated genomes submitted as drafts/contigs.
In the scenario for a simple pan-genomic profile based on 3 annotated genomes ( Supplementary Fig. 1 B), the first step that PanCoreGen performs is a BLAST analysis of annotated genes of the current reference genome (here genome A) against other genomes, annotated and un-annotated (here two annotated genomes B and C). This creates three sets of information — (i) the genes that are specific to the current reference (genome A), (ii) the genes that have orthologs in at least one other genome — i.e. mosaic genes specific to genomes A and B or to genomes A and C, and (iii) the core genes present in all three genomes.
In the scenario for a simple pan-genomic profile based on 3 annotated genomes (Supplementary Fig. 1B), the first step that PanCoreGen performs is a BLAST analysis of annotated genes of the current reference genome (here genome A) against other genomes, annotated and un-annotated (here two annotated genomes B and C). This creates three sets of information — (i) the genes that are specific to the current reference (genome A), (ii) the genes that have orthologs in at least one other genome — i.e. mosaic genes specific to genomes A and B or to genomes A and C, and (iii) the core genes present in all three genomes.
Next, PanCoreGen considers another genome as reference (here genome B), and performs BLAST only on those annotated genes of this reference that are not identified as orthologous to any annotated gene using the previous reference genome (here genome A). This step provides information on the genes unique to the current reference (genome B) and mosaic genes specific to genomes B and C. Also, importantly, it allows expansion of the set of genes specific to genomes A and B as well as the set of core genes, thereby identifying any un-annotated genes in genome A. From this point, the core genes are A + B core, since PanCoreGen has used both genomes A and B as reference.
Finally, genome C is used as reference, where only the annotated genes not identified yet in genome A or genome B are used for BLAST against other genomes. This step informs us of the genes specific to the current reference (genome C), expands the sets of mosaic genes specific to genomes A and C and to genomes B and C. The size of the core gene set also maximizes as A + B + C core, since PanCoreGen now uses all annotated genomes as reference. In this example scenario, the 7 sets of genes – one core, three mosaic and three reference genome-specific ( Supplementary Fig. 1 A) – constitute the pan-genome that altogether can be used as a combined reference for the annotation of any submitted draft genomes/contigs.
Finally, genome C is used as reference, where only the annotated genes not identified yet in genome A or genome B are used for BLAST against other genomes. This step informs us of the genes specific to the current reference (genome C), expands the sets of mosaic genes specific to genomes A and C and to genomes B and C. The size of the core gene set also maximizes as A + B + C core, since PanCoreGen now uses all annotated genomes as reference. In this example scenario, the 7 sets of genes – one core, three mosaic and three reference genome-specific (Supplementary Fig. 1A) – constitute the pan-genome that altogether can be used as a combined reference for the annotation of any submitted draft genomes/contigs.
PanCoreGen is developed for Windows using PERL and Visual Basic. Minimum system requirements are 4 GB RAM, a dual-core or equivalent processor, and 60 MB of hard-disk space for program installation.
Input requirements PanCoreGen user interface is shown in Fig. 2 . The program reads both annotated genome files and un-annotated draft sequences. Annotated genome sequences are accepted as input in GenBank format. For the draft genomes, on the other hand, FASTA-formatted sequence files are needed. In each draft genome file, users can input either a concatenated sequence with a single FASTA header, or an array of contigs in FASTA. Any multi-FASTA file will automatically be concatenated by our program to single FASTA for the analysis (see “Documentation.pdf”, included in the installer, for more input-details). The interface allows users to directly connect to microbial genome databases in GenBank, and to download the complete genome sequences of their interest. Additionally, users have the option to include their own annotated genome sequences (in GenBank format) for analysis. Given the genome sequences, the program uses standalone BLAST (incorporated in the PanCoreGen_installer.exe file) for the extraction of orthologous genes.
As the genome database is created, the PanCoreGen run requires incorporating all the genome file names within a ‘database-link’ file through the “Create Database-link File” option in the interface ( Fig. 2 ). Users then need to assign the lower limit (in percentage) for nucleotide identity and length coverage to perform MegaBLAST (ideal for very closely-related strains) or BLASTN for the detection of orthologous gene sequences. Users have the option to turn on or off (default) the BLAST filtering feature (DUST) which, if enabled, masks off the low complexity regions in the query sequence. For all other features in BLAST for sequence alignment, PanCoreGen uses the parameters set as default in BLAST. Besides, there are three other options to perform additional analyses. The first one asks if users want to perform pan-genomic analysis of specific strain-groups ( Fig. 2 ). If the answer is ‘yes’, a new menu appears for users to choose the number of groups and to assign the strains (by selecting the corresponding genome files) within each group. Another option is to annotate any draft genomes ( Fig. 2 ). If ‘yes’ is chosen, users select in a new window the draft genomes to be annotated. Besides, users can also reannotate any existing annotated genomes by selecting the genome file names in a new window ( Fig. 2 ). The Detailed input requirements are in the “Documentation.pdf” file included in the installer.
We applied the PanCoreGen program on publicly available annotated genomes of 17 Salmonella enterica subspecies I strains ( Supplementary Table 1 ). Using the Windows platform (Intel core i7 processor, 8 GB RAM), it took 16 h to complete the run. For the BLASTN search of orthologs, we used 95% sequence identity and length coverage as the lower limit. Also, the DUST filter was disabled to avoid possible exclusion of orthologs due to the masking of any query sequence. We considered S. enterica ParatyphiB SPB7 as the first reference genome, due to the presence of most annotated genes. We then calculated the pairwise distance of 7 concatenated housekeeping genes used for multi-locus sequence typing [11,21] of SPB7 with other 16 strains, and incorporated other genomes based on their increasing phylogenetic distance from SPB7.
We applied the PanCoreGen program on publicly available annotated genomes of 17 Salmonella enterica subspecies I strains (Supplementary Table 1). Using the Windows platform (Intel core i7 processor, 8 GB RAM), it took 16 h to complete the run. For the BLASTN search of orthologs, we used 95% sequence identity and length coverage as the lower limit. Also, the DUST filter was disabled to avoid possible exclusion of orthologs due to the masking of any query sequence. We considered S. enterica ParatyphiB SPB7 as the first reference genome, due to the presence of most annotated genes. We then calculated the pairwise distance of 7 concatenated housekeeping genes used for multi-locus sequence typing [11,21] of SPB7 with other 16 strains, and incorporated other genomes based on their increasing phylogenetic distance from SPB7.
Outputs As two major outputs, PanCoreGen provides a profile of core genes in a spreadsheet “Core_genes.xls” and a complete profile of core, mosaic and strain-specific genes in another spreadsheet “Gene_distribution.xls”. These files include gene-specific detailed annotation information about source isolate, genomic region, encoded protein length and function, number and names of representative isolates of the analyzed species. In both files, the genes that accumulate truncation mutations due to either frameshifts or premature stop codons in certain strains are marked by asterisks (*) in the corresponding strain-names. Additionally, a separate spreadsheet file “Core_stop_genes.xls” is generated for core genes with truncation mutations in one or multiple strains.
Another important output is a FASTA-formatted file, “panseq.txt”, incorporating nucleotide sequences of all alleles (i.e. unique genes) based on all annotated genomes as reference. Separately, for each gene, PanCoreGen generates a FASTA-formatted nucleotide sequence dataset including all orthologs from sample set genomes, both annotated and un-annotated. For a given gene, the headers for orthologous sequences show respective genomic coordinates.
Similar to the overall pan-genomic profile output (i.e. “Gene_distribution.xls”), PanCoreGen generates within-group pan-genomic profiles for user-defined strain-groups. The results of each user-defined group are stored in a dedicated spreadsheet file “Group_G < 1-10 >_specific_genes.xls”. The draft genome annotation module of PanCoreGen allows the user to annotate any number of draft genomes using the pan-genomic gene database as reference. For each draft genome, a spreadsheet with the precise information on each ortholog in draft genomes/contigs, and the annotation of the corresponding reference gene is generated. Also, a FASTA-formatted text file is prepared for each annotated gene of the draft genomes/contigs. Similarly for reannotation of existing annotated genomes, a spreadsheet with reannotated genes is created.
For our example set, it is expected that the increase in gene-content would be much less for the inclusion of a strain of the same serovar compared to the addition of a new serovar, as noticed during the addition of the second and third Typhimurium strains, second Paratyphi A, and second Typhi strain vs. the addition of the first one for the corresponding serovar ( Fig. 3 A ). PanCoreGen, using its cross-reference BLAST approach with all the annotated genes, detects un-annotated gene in all the genomes analyzed. The black line in Fig. 3 A represents the sequential contribution of each completely sequenced genome in the overall set of core genes detected. Importantly, in our approach, each genome, as added, was used as reference to re-annotate the genes of the pre-existing genome-set. Addition of any well-annotated genome (e.g. 14028S) was found to increase the core gene-content considerably. This clearly reflects the extent of incompleteness and inconsistency in genome annotations, where many core genes were annotated in one or a few genomes, but either not or partially annotated in other genomes despite their complete presence. Therefore, PanCoreGen enables annotation of such unannotated genes, thereby developing an extensive and unified pan-genomic profile of the given genomes.
PanCoreGen identifies a total of 9104 genes in the pan-genome consisting of 47% core genes (present in all 17 genomes), 36% mosaic genes (present in 2 to 16 genomes) and 17% that are strain-/serovar-specific ( Fig. 3 B). Analysis showed the presence of only one gene specific to human-restricted serovar Paratyphi A. However, when we assigned Paratyphi A and another human-restricted serovar, Typhi as a group, PanCoreGen showed the presence of 59 genes specific to this group of two host-restricted serovars ( Supplementary Table 2 ). We detected contiguous genomic locations for several of these genes (as evident from the gene coordinates in Supplementary Table 2 ), encoding a number of membrane and regulatory proteins. We further conducted functional classification analysis of these genes using DAVID [22] and found the DNA metabolic process to be an enriched functional category (enrichment score 1.76; 2 × 2 χ 2 p = 0.004) including 6 genes — SSPA2386, SSPA2413, SSPA2414, SSPA3483, SSPA4034, and SSPA4035 ( Supplementary Table 2 ). Since these two serovars do not share a close common ancestry [23] , the results suggest independent acquisition as genomic islands via horizontal gene transfer. This leads us to speculate on the possible role of gene transfer in adaptive convergent evolution of Paratyphi A and Typhi, in addition to recombination [23] and mutation [11] as demonstrated by previous studies. Group-specific analysis, a unique feature of PanCoreGen, thus indicates its possible important contribution in understanding common virulence factors linked to specific disease manifestations.
PanCoreGen identifies a total of 9104 genes in the pan-genome consisting of 47% core genes (present in all 17 genomes), 36% mosaic genes (present in 2 to 16 genomes) and 17% that are strain-/serovar-specific ( Fig. 3 B). Analysis showed the presence of only one gene specific to human-restricted serovar Paratyphi A. However, when we assigned Paratyphi A and another human-restricted serovar, Typhi as a group, PanCoreGen showed the presence of 59 genes specific to this group of two host-restricted serovars (Supplementary Table 2). We detected contiguous genomic locations for several of these genes (as evident from the gene coordinates in Supplementary Table 2), encoding a number of membrane and regulatory proteins. We further conducted functional classification analysis of these genes using DAVID [22] and found the DNA metabolic process to be an enriched functional category (enrichment score 1.76; 2 × 2 χ 2 p = 0.004) including 6 genes — SSPA2386, SSPA2413, SSPA2414, SSPA3483, SSPA4034, and SSPA4035 (Supplementary Table 2). Since these two serovars do not share a close common ancestry [23] , the results suggest independent acquisition as genomic islands via horizontal gene transfer. This leads us to speculate on the possible role of gene transfer in adaptive convergent evolution of Paratyphi A and Typhi, in addition to recombination [23] and mutation [11] as demonstrated by previous studies. Group-specific analysis, a unique feature of PanCoreGen, thus indicates its possible important contribution in understanding common virulence factors linked to specific disease manifestations.
Conclusions One limitation of the present version of PanCoreGen lies in a possible overestimation of allelic counterparts of genes that are duplicated in one genome (primarily if it is the first genome considered as reference), but present as a single copy in any other genomes. It is a possibility that, depending on the thresholds of nucleotide sequence identity and length coverage and the level of diversity between duplicated genes, both duplicated genes used as query would detect the same sequence from the subject genome as their alleles. Also, it should be mentioned that PanCoreGen entirely depends on the annotations of completely sequenced genomes available in the dataset to be analyzed. Therefore, each gene in the final pan-genomic set must be annotated in at least one genome of the input database. In the future development of this application, we plan to include strategies to overcome these limitations. Additionally, we aim to incorporate user-options for each of the parameters used for optimal alignment during BLAST analysis. However, on the other side, PanCoreGen offers the flexibility to choose any genomes of interest – within- or between-species or both – to allow the user to reconstruct pan-genomic profiles of the complete dataset, and also of any subsets of interest. To cope with the exponential accumulation of sequenced microbial genomes, PanCoreGen enables users to download completed genomes from the GenBank database, thereby offering access to the latest genomic data, in addition to in-house completed and draft genome sequences, for analysis. Another major uniqueness of our tool is the availability of gene-specific sequence datasets (representing both completely sequenced genomes and drafts/contigs) as outputs for any detailed evolutionary analysis of genes/proteins of interest. These FASTA-formatted gene sequence datasets can directly serve as inputs for the analysis of DNA polymorphisms (e.g. DnaSP [24] ), phylogenetics (e.g. MEGA [25] ), genome-wide selection dynamics (e.g. TimeZone [26] ), etc. Also, the annotation information (such as GI numbers and locus tags) associated with the genes of a user's interest can be readily used as inputs for the analysis of functional classification and enrichment of encoded proteins (using DAVID [22] , Comparative GO [27] , etc.).
Altogether, PanCoreGen represents a valuable user-friendly tool for pan-genomic profiling important in the study of both phylogenomics and pathogenomics. The re-annotation approach of PanCoreGen to build larger, unified core fractions of the protein-coding genes can lead to the development of powerful genotyping tools with high discriminatory power within and/or across species. This would be crucial in rapid, high resolution diagnosis of pathogenic clones.
Also, the ever-increasing pace and precision of genome sequencing clearly predicts the accumulation of tens of thousands of microbial genome sequences within the next decade [12] , thereby allowing genome-wide association studies of microbial species, especially of their pathogenic counterparts. We believe that the unique features of PanCoreGen, such as group-specific gene-profiles and identification of important genes un-annotated in completely sequenced genomes, would emerge as powerful aids to link genes with the ability of pathogens to cause disease.
The following are the supplementary data related to this article. Supplementary Table 1 List of S. enterica subspecies I strains analyzed. Supplementary Table 2 List of protein-coding genes that are exclusively present in Typhi and Paratyphi A serovars of S. enterica , out of 13 serovars analyzed. The genes with asterisks (*) denote the representatives of the overrepresented protein functional category — DNA metabolic process, as detected by DAVID [22] . Supplementary Fig. 1 Schematic diagram of information derived from PanCoreGen. (A) Core, mosaic and genome-specific pan-genomic profiles. (B) Venn diagram showing 7 sets of gene profiles generated from 3 annotated genomes.
Supplementary data to this article can be found online at http://dx.doi.org/10.1016/j.ygeno.2015.10.001 .