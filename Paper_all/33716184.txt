https://doi.org/10.1016/j.ygeno.2021.03.018
Title: Polishing the Oxford Nanopore long-read assemblies of bacterial pathogens with Illumina short reads to improve genomic analyses
Abstract: Oxford Nanopore sequencing has been widely used to achieve complete genomes of bacterial pathogens. However, the error rates of Oxford Nanopore long reads are high. Various polishing algorithms using Illumina short reads to correct the errors in Oxford Nanopore long-read assemblies have been developed. The impact of polishing the Oxford Nanopore long-read assemblies of bacterial pathogens with Illumina short reads on improving genomic analyses was evaluated using both simulated and real reads. Ten species (10 strains) were selected for simulated reads, while real reads were tested on 11 species (11 strains). Oxford Nanopore long reads were assembled with Unicycler to produce a draft assembly, followed by three rounds of polishing with Illumina short reads using two polishing tools, Pilon and NextPolish. One round of NextPolish polishing generated genome completeness and accuracy parameters similar to the reference genomes, whereas two or three rounds of Pilon polishing were needed, though contiguity remained unchanged after polishing. The polished assemblies of
Escherichia coli O157:H7, Salmonella Typhimurium, and Cronobacter sakazakii with simulated reads did not provide accurate plasmid identifications. One round of NextPolish polishing was needed for accurately identifying plasmids in
Staphylococcus aureus and E. coli O26:H11 with real reads, whereas one and two rounds of Pilon polishing were necessary for these two strains, respectively. Polishing failed to provide an accurate antimicrobial resistance (AMR) genotype for
S. aureus with real reads. One round of polishing recovered an accurate AMR genotype for Klebsiella pneumoniae
with real reads. The reference genome and draft assembly of Citrobacter braakii with real reads differed, which carried
blaCMY-83 and fosA6 , respectively, while both genes were present after one round of polishing. However, polishing did not improve the assembly of
E. coli O26:H11 with real reads to achieve numbers of virulence genes similar to the reference genome. The draft and polished assemblies showed a phylogenetic tree topology comparable with the reference genomes. For multilocus sequence typing and pan-genome analyses, one round of NextPolish polishing was sufficient to obtain accurate results, while two or three rounds of Pilon polishing were needed. Overall, NextPolish outperformed Pilon for polishing the Oxford Nanopore long-read assemblies of bacterial pathogens, though both polishing strategies improved genomic analyses compared to the draft assemblies.
Introduction Advances in next-generation sequencing (NGS) have ushered in a new era of whole-genome analysis for bacterial pathogens. The low-cost Illumina reads with a low error rate of <0.5% make them well suited to high-throughput genomics, allowing Illumina platforms to become the most dominant technology for whole-genome sequencing (WGS) of bacteria [ 24 ]. The major shortcoming of Illumina reads is their length: maximally 300 bp but more commonly ≤150 bp [ 33 ]. Using Illumina short reads alone cannot resolve repeated sequences longer than the reads Illumina sequencing can span, and thus may fail to assemble mobile genetic elements and genomic duplications [ 23 ]. While Illumina short reads are sufficient for some genomic analyses such as strain typing and outbreak tracing, incomplete bacterial genomes can lead to mapping artifacts, missed gene calls, and inaccurate repeat construction [ 6 , 7 ]. Of particular concern to many, it may be impossible to tell from an incomplete Illumina short-read assembly whether genes of interest such as antimicrobial resistance genes (ARGs) reside on the chromosome or a plasmid [ 1 ]. This is a hindrance to researchers and public health laboratories, as the locations of these genes have substantial values for epidemiological implications.
Oxford Nanopore sequencing can overcome these limitations by generating long reads on the principle of real-time nanopore strand sequencing, which increases read lengths 100- to 1000-fold and spans much longer repeat regions compared to Illumina platforms [ 48 ]. The long-read lengths of Oxford Nanopore sequencing and improvements to bioinformatic tools to assemble bacterial genomes from long reads make this technology a viable option for achieving complete genomes of bacterial pathogens [ 34 ]. With Oxford Nanopore sequencing, the full structure of a bacterial genome can reveal the locations of all genes [ 2 , 9 , 11 ]. Despite the ability to produce highly contiguous assemblies, Oxford Nanopore long reads have a high error rate of 10%–15% [ 28 ]. The accuracy of the resulting sequence is not equivalent to that achieved with Illumina short reads, even after using error-correcting tools based on Oxford Nanopore long reads alone such as Nanopolish [ 27 ].
Although there are concerns about the high error rate with Oxford Nanopore sequencing, integrated approaches that efficiently utilize both long and short reads can overcome this problem. One solution is to polish the Oxford Nanopore long-read assembly with highly accurate Illumina short reads to improve the accuracy [ 18 , 47 ]. This approach does not rely on specific standalone assemblers but can be accomplished using long-read assemblers to create a draft assembly, followed by a polishing step with Illumina short reads. So far, Pilon has been the most widely used polishing tool in the published literature beyond the initial release of the software [ 47 ]. Pilon can utilize Illumina short reads mapped to the draft assembly to improve the local accuracy of the sequence by correcting sequence errors, fixing misassemblies, and filling gaps. Utilizing Illumina short reads, Pilon has been used to polish the Oxford Nanopore long-read assemblies of bacterial pathogens for comprehensive assembly improvement [ 12 , 43 , 45 ].
Recently, Hu et al. [ 18 ] has developed a fast and efficient polishing tool, NextPolish, that can correct sequence errors in long-read assemblies. When the polishing efficiency of NextPolish on human and plant genomes was evaluated, NextPolish outperformed Pilon by correcting sequence errors to produce a higher genome accuracy. Vera et al. [ 46 ] used NextPolish to error-correct the Oxford Nanopore long-read assemblies of six Bacillus megaterium strains with Illumina short reads. However, NextPolish has not been reported to polish the Oxford Nanopore long-read assemblies of bacterial pathogens. Moreover, we are not aware of any previously published direct comparisons of Pilon and NextPolish for polishing the Oxford Nanopore long-read assemblies of bacterial pathogens with Illumina short reads to improve genomic analyses. Because of their critical importance to public health and food safety, elucidation of polishing strategies to provide accurate genomic analyses of bacterial pathogens is urgently needed.
In the current study, we thus used Pilon and NextPolish to polish the Oxford Nanopore long-read assemblies of bacterial pathogens with Illumina short reads, spanning a wide range of genome sizes and GC contents, for up to three rounds. After each round of polishing, we assessed and compared the genome completeness and accuracy of the Pilon- and NextPolish-polished assemblies relative to the reference genomes. The impact of iterative polishing on improving genomic analyses of bacterial pathogens was evaluated. Noticeably, both simulated and real reads were tested in this work. Simulated reads allow for a confident ground truth as the underlying genome is well-established and known with certainty. Additionally, by using a long-read simulator such as Badread [ 50 ], the quality parameters of simulated reads can be experimentally adjusted to mimic Oxford Nanopore long reads with different levels of sequence error. Beyond considerations of the advantages of simulated reads, an important concern is that they are generally unrealistic because simulators are not able to model all relevant features of Oxford Nanopore long reads. Therefore, the assemblies of real reads were also analyzed to incorporate realistic features of Oxford Nanopore long reads such as error profiles, read lengths, and quality scores.
Methods Simulated Illumina short reads and Oxford Nanopore long reads Ten bacterial strains of bacterial pathogens with each representing one species were used as the source for simulated reads ( Table 1 ), which encompass a broad range of genome size and GC content. Their reference genomes with fully closed genomes were obtained from the National Center for Biotechnology Information (NCBI) Reference Sequence (RefSeq) Database (Table S1). We used ART 2.5.8 [ 19 ] to produce simulated Illumina paired-end short reads from each reference genome to mimic those yielded from an Illumina MiSeq platform with a read length of 250 bp, mean fragment size of 400 bp, fragment size standard deviation of 60 bp, and coverage of 50×. Badread 0.1.5 [ 50 ] was applied to generate simulated Oxford Nanopore long reads based on the Nanopore error model, with a mean fragment size of 15,000 bp, fragment size standard deviation of 13,000 bp, mean identity of 85, max identity of 95, identity standard deviation of 5, chimera join rate of 1%, junk read rate of 1%, random read rate of 1%, and coverage of 50×. NanoPlot 1.33.0 [ 8 ] was used to further assess the quality of simulated Oxford Nanopore long reads. Oxford Nanopore ligation adapters were added to the start and end of each read using Badread, with a start adapter rate of 90 and start adapter amount of 60, and an end adapter rate of 50 and end adapter amount of 20. Start and end adapter sequences were AATGTACTTCGTTCAGTTACGTATTGCT and GCAATACGTAACTGAACGAAGT, respectively.
Real Illumina short reads and Oxford Nanopore long reads Real Illumina short reads and Oxford Nanopore long reads of 11 bacterial strains of bacterial pathogens with each representing one species ( Table 2 ), spanning a wide range of genome sizes and GC contents, were obtained from the Sequence Read Archive (SRA) of the NCBI (Table S2). The quality of real Oxford Nanopore long reads was evaluated using NanoPlot 1.33.0. PacBio assemblies as the reference genomes for strains with real reads were downloaded from the NCBI. For strains with no publicly available PacBio assemblies, PacBio long reads were assembled using the long-read-only assembly pipeline of Unicycler 0.4.8 [ 49 ].
Pilon- and NextPolish-based assembly-polishing pipelines Raw sequence reads were processed through two customized assembly-polishing pipelines using both Oxford Nanopore long reads and Illumina short reads. The Pilon-based assembly-polishing pipeline consecutively invoked Porechop 0.2.4, Unicycler 0.4.8, Bowtie2 2.4.1, and Pilon 1.23, while the NextPolish-based assembly-polishing pipeline consecutively invoked Porechop 0.2.4, Unicycler 0.4.8, and NextPolish 1.2.4.
The ligation adapters in raw Oxford Nanopore long reads with a minimum identity of 75% were trimmed from read ends using Porechop 0.2.4 ( https://github.com/rrwick/Porechop ). When a read had an adapter with a minimum identity of 85% in its middle, it was considered as chimeric and cleaved into two separate reads with the adapter subsequently removed. Trimmed Oxford Nanopore long reads of each strain were then assembled using the long-read-only assembly pipeline of Unicycler 0.4.8 [ 49 ].
When implementing Pilon, three rounds of polishing were run iteratively on the Unicycler assemblies, with Illumina short reads aligned to the polished assemblies obtained from the previous round and indexed at each iteration using Bowtie2 2.4.1. The assemblies and their corresponding alignments were then passed to Pilon 1.23 [ 47 ] to call consensus. With NextPolish, the Unicycler assemblies were subjected to three iterations of polishing using NextPolish 1.2.4, with 1 and 2 as the algorithm modules for Illumina short reads indexed in a paired-end read file (sgs_fofn) [ 18 ].
Computational environments Pilon and NextPolish polishing were performed on the Linux operating system of Ubuntu 20.04 LTS on a computer with 16 threads of CPU and 32 GB of RAM. To avoid any performance variation caused by CPU overcommit, 12 threads of CPU were allocated in the option of the number of threads to use for Pilon and NextPolish.
Assessment of genome completeness and accuracy Quast 5.0.2 [ 17 ] was used to compute the number of contigs, genome size, and GC content. The genome completeness of each assembly was assessed by performing a benchmarking universal single-copy ortholog (BUSCO) analysis using BUSCO 4.0.6 [ 39 ] based on the length alignments to the BUSCO profiles, with 0.01 as the E -value cutoff for BLAST searches and three candidate regions to consider. The level of genome completeness was expressed as BUSCO scores, including complete, fragmented, and missing BUSCOs that indicate the fractions of high-identity full-length genes, partially present genes, and absent genes, respectively. Single nucleotide polymorphisms (SNPs) of each assembly relative to the corresponding reference genome were called using CSI Phylogeny 1.4 with default settings [ 22 ], with 10× as the minimum depth at SNP positions, 10% as the minimum relative depth at SNP positions, 10 bp as the minimum distance between SNPs, 30 as the minimum SNP quality, 25 as the minimum read mapping quality, and 1.96 as the minimum Z -score. The number of SNPs was reported as the number of SNPs per one million bp of the reference genome. To study the similarity between each assembly and the corresponding reference genome, the orthologous average nucleotide identity (OrthoANI) value was calculated by aligning the assembly to the reference genome using the ChunLab's online Average Nucleotide Identity (ANI) calculator [ 53 ].
Identifications of plasmids, ARGs, and virulence genes Plasmids were detected using staramr 0.6.0 ( https://github.com/phac-nml/staramr ) against known plasmid sequences in the PlasmidFinder database [ 3 ], with 98% as the minimum identity and 60% as the minimum coverage. ARGs were identified using staramr 0.6.0 through the comparison with known gene sequences in the ResFinder database [ 54 ], with 98% as the minimum identity and 60% as the minimum coverage. ABRicate 0.8.7 ( https://github.com/tseemanN.A.bricate ) incorporated with the Virulence Factors Database (VFDB) [ 5 ] was used to identify virulence genes, with 80% as the minimum identity and 60% as the minimum coverage compared with known gene sequences.
Multilocus sequence typing (MLST) MLST was performed using mlst 2.19.0 ( https://github.com/tseemann/mlst ) with integrated components of the PubMLST database [ 21 ] by scanning genomes against traditional PubMLST typing schemes based on seven housekeeping genes. The MLST scheme was automatically set, with 95% as the minimum identity of full allele, 10% as the minimum coverage of partial allele, and 50 as the minumum score to match a scheme.
Whole- and core-genome phylogenetic analyses Pseudomonas aeruginosa PAO1 with simulated reads and Listeria monocytogenes CFSAN008100 with real reads were combined with 30 strains of P. aeruginosa (Table S3) and L. monocytogenes (Table S4), respectively, to examine how Pilon and NextPolish polishing affected whole-genome phylogenetic inference. CSI Phylogeny 1.4 was used with default settings aforementioned to call SNPs and infer phylogeny based on the concatenated alignment of the high-quality SNP. P. aeruginosa DSM 50071 (RefSeq assembly accession: GCF_001045685.1) and L. monocytogenes EGD-e (RefSeq assembly accession: GCF_000196035.1) served as the reference genomes for P. aeruginosa PAO1 and L. monocytogenes CFSAN008100, respectively.
To perform core-genome phylogenetic analyses, Escherichia coli O157:H7 Sakai with simulated reads and Cronobacter sakazakii CFSAN068773 with real reads were combined with 30 strains of Shiga-toxin producing E. coli (STEC) (Table S5) and C. sakazakii (Table S6), respectively. The alignment of core genomes was carried out using Parsnp 1.2 [ 44 ], with the reference genome automatically recruited and all genomes included in the final phylogeny.
The inferred whole- and core-genome phylogenies were drawn as rectangular phylograms using Geneious Prime 2020.2.1. (Biomatters, Ltd., Auckland, New Zealand).
Pan-genome analyses Salmonella Typhimurium LT2 with simulated reads and Campylobacter coli CFSAN032805 with real reads were selected for pan-genome analyses, with 20 strains of S. Typhimurium (Table S7) and C. coli (Table S8) included, respectively. Genome sequences were annotated with Prokka 1.14.0 [ 36 ]. Afterward, pan genomes were analyzed with Roary 3.12.0 [ 32 ] using the annotated genomes as input to calculate the numbers of core, soft-core, shell, and cloud genomes.
Statistical analysis The Wilcoxon signed rank tests were performed using SigmaPlot 14.0 (Systat Software Inc., San Jose, CA) to determine whether there were significant differences ( P < 0.05) between Pilon- and NextPolish-polished assemblies after three rounds of polishing in genome size, GC content, complete, fragmented, and missing BUSCOs, number of SNPs, OrthoANI values, and number of virulence genes. The Pilon- and NextPolish-polished assemblies were also compared with the reference genomes after each round of polishing to see if significant differences ( P < 0.05) could be observed in genome size, GC content, complete, fragmented, and missing BUSCOs, and number of virulence genes.
Results and discussion Polishing strategies of Pilon and NextPolish According to Walker et al. [ 47 ], Pilon first scans the read alignments for evidence where Illumina short reads disagree with the Oxford Nanopore long-read assembly and makes corrections to small errors and detects small variants. Pilon then looks for coverage and alignment discrepancies to identify potential misassemblies and larger variants. Finally, Pilon uses reads and mate pairs which are anchored to the flanks of discrepant regions and gaps in the Oxford Nanopore long-read assembly to reassemble the area. Walker et al. [ 47 ] demonstrated that there are several areas where improvements could be made in Pilon concerning assembly improvement and variant calling. They thus indicated some benefits in iteratively applying Pilon for assembly improvement and insertion variant calling process.
In contrast to Pilon, NextPolish contains two unique interlinked core modules that are designed to score and count k -mers from high-quality short reads, and to polish genome assemblies containing large numbers of base errors [ 18 ]. The first module is the k -mer score chain module that calculates a confidence score for a given allele at each position. The second module is the k -mer count module that re-maps Illumina short reads to the assembly obtained from the previous module to correct the low-quality and low-depth positions due to incorrect mapping of error-enriched regions. Meanwhile, the k -mer score chain module is applied again to improve the correction accuracy for the low-depth positions at which the valid depth is increased during the short-read re-mapping.
Genome completeness and accuracy The mean read quality scores of raw long reads reported in recent studies on Oxford Nanopore sequencing of bacterial pathogens were around 10 (basecalling accuracy of 90%) ([ 15 , 16 , 20 , 42 , 52 ]. Therefore, to be consistent with recently published literature and also achieve realistic benchmarking results, we chose the mean read quality scores of 10 when simulating Oxford Nanopore long reads (File S1).
The assemblies of simulated Oxford Nanopore long reads were polished with simulated Illumina short reads using Pilon and NextPolish ( Tables 1 and 2 ), which were then compared to the corresponding reference genomes. The genome completeness and accuracy of a polished assembly of simulated reads that contained experimentally introduced error profiles reflects the robustness of the polishing process to tolerate a variety of read parameters [ 51 ]. When using simulated long reads, none of the contigs were circularized. Five out of the 10 draft assemblies had numbers of contigs consistent with the reference genomes. The numbers of contigs and dead ends of each assembly did not change after Pilon and NextPolish polishing, indicating that both polishing strategies had no impact on assembly contiguity. The genome sizes of the draft assemblies were significantly smaller ( P < 0.05) than those of the reference genomes, which could be due to the errors and misassemblies produced when simulated reads were assembled. Their genome sizes expanded after the first and second rounds of Pilon polishing but did not increase with further rounds of polishing. As such, after three rounds of polishing, the genome sizes of the Pilon-polished assemblies were still significantly smaller ( P < 0.05) compared to the reference genomes, with only one exception where C. sakazakii ATCC 29544 had a slightly larger genome size (4,671,961 bp) than the reference genome (4,663,565 bp). In contrast, genome sizes reached a plateau after a single round of NextPolish polishing, though the genome sizes of the NextPolish-polished assemblies were also significantly smaller ( P < 0.05) than those of the reference genomes. After three rounds of polishing, the genome sizes of the Pilon-polished assemblies were significantly smaller ( P < 0.05) than those of the NextPolish-polished assemblies. The GC contents of the draft assemblies were consistent with those of the reference genomes. And we observed no noticeable change in GC content after Pilon and NextPolish polishing, as there were no significant differences ( P > 0.05) in GC content among the reference genomes, draft assemblies, and polished assemblies.
The averages of complete, fragmented, and missing BUSCOs of the draft assemblies of simulated reads were 58.3%, 22.1%, and 19.6, respectively, while the reference genomes had a significantly higher ( P < 0.05) average of complete BUSCOs (98.4%), and lower ( P < 0.05) averages of fragmented (0.2%) and missing BUSCOs (1.4%) (Table S9). The largest gains in genome completeness were achieved from the first round of Pilon and NextPolish polishing (Tables S9 and S10). After one round of polishing, the average of complete BUSCOs of the Pilon-polished assemblies increased to 96.3%, while the averages of fragmented and missing BUSCOs decreased to 0.9% and 2.9%, respectively. After two rounds of Pilon polishing, the assemblies exhibited only minor improvements to the averages of complete (97.2%), fragmented (0.2%), and missing BUSCOs (2.6%). The complete BUSCOs of the Pilon-polished assemblies became similar ( P > 0.05) to those of the reference genomes after two rounds of polishing, whereas one round of Pilon polishing was needed to achieve fragmented and missing BUSCOs similar ( P > 0.05) to those of the reference genomes. And no further improvements were observed after three rounds of Pilon polishing. After the first round of NextPolish polishing, the average of complete BUSCOs increased to 97.2%, while the averages of fragmented and missing BUSCOs decreased to 0.2% and 2.6, respectively. Two additional rounds of NextPolish polishing did not further improve the overall genome completeness, as no significant differences ( P > 0.05) in complete, fragmented, and missing BUSCOs were found between the reference genomes and NextPolish-polished assemblies only after one round of polishing. After three rounds of polishing, there were no significant differences ( P > 0.05) in complete, fragmented, and missing BUSCOs between the Pilon- and NextPolish-polished assemblies.
The draft assemblies had a higher average SNP number (18 SNPs per one million bp of the reference genome) than the Pilon- and NextPolish-polished assemblies of simulated reads. After one round of polishing, a lower average SNP number was identified in the NextPolish-polished assemblies (one SNP per one million bp of the reference genome) compared to the Pilon-polished assemblies (five SNPs per one million bp of the reference genome) (Table S13). After the subsequent two rounds of polishing, none of the Pilon-polished assemblies contained SNPs, whereas NextPolish did not make further corrections. After three rounds of polishing, the Pilon-polished assemblies had significantly higher ( P < 0.05) numbers of SNPs compared to the NextPolish-polished assemblies. The draft assemblies had an average of OrthoANIu values of 99.74% (Table S15), while one round of Pilon and NextPolish polishing increased the sequence identity to the reference genome to 99.96%. Additional polishing with Pilon and NextPolish did not increase the averages of OrthoANIu values. After three rounds of polishing, no significant differences ( P > 0.05) were observed in OrthoANIu value between the Pilon- and NextPolish-polished assemblies.
Given a set of real reads that incorporates naturally occurring features of Oxford Nanopore long reads, the genome completeness and accuracy of a polished assembly indicates the reliability of the polishing process to achieve a complete and accurate assembly [ 51 ]. The average mean read quality score of real reads was 10.3, which was similar to that of simulated reads. The draft assemblies of real reads were more contiguous than those of simulated reads ( Table 3 ), as Unicycler completed the genomes of four out of the 11 strains. Among the genomes Unicycler completed, the draft assemblies of Klebsiella pneumoniae CFSAN086181, S. Bareilly CFSAN000189, and C. coli CFSAN032805 had numbers of contigs consistent with the reference genomes. The genome sizes of the draft assemblies of eight out of the 11 strains were larger than those of the reference genomes, while the draft assemblies of K. pneumoniae CFSAN086181, S. Bareilly CFSAN000189, and C. coli CFSAN032805 had similar genome sizes to the reference genomes. The draft assemblies of Citrobacter braakii CFSAN086182 and C. jejuni CFSAN032806 had inaccurate genome sizes of >9,900,000 bp and > 4,000,000 bp, respectively, compared to the reference genomes whose genome sizes were 4,917,511 bp and 1,782,911 bp, respectively. The genome sizes of both the draft assemblies, and Pilon- and NextPolish-polished assemblies were significantly smaller ( P < 0.05) than those of the reference genomes ( Tables 3 and 4 ) , indicating that polishing did not significantly correct the genome sizes. After three rounds of polishing, the genome sizes of the Pilon- and NextPolish-polished assemblies were similar ( P > 0.05) to each other. Similar to when simulated reads were used, the contiguity of the assemblies of real reads was not improved after Pilon and NextPolish polishing. The GC contents of the draft assemblies were similar to those of the reference genomes, with only one exception that the draft assembly of C. braakii CFSAN086182 had a higher GC content of 54.91% than the reference genome (52.05%). Pilon and NextPolish did not significantly impact the GC contents of the draft assemblies, as there were no significant differences ( P > 0.05) in GC content among the reference genomes, draft assemblies, and polished assemblies.
The averages of complete, fragmented, and missing BUSCOs of the reference genomes with real reads were 97.0%, 0.5%, and 2.5% (Table S11), while those of the draft assemblies were significantly different ( P < 0.05), at 40.8%, 27.3%, and 31.9%, respectively. The largest improvements to genome completeness were observed after the first round of Pilon and NextPolish polishing, which was congruent with the results when simulated reads were used (Tables S11 and S12). Much less but still noticeable improvements were achieved with the additional two rounds of Pilon polishing. After three rounds of Pilon polishing, the average of complete BUSCOs of the polished assemblies increased to 94.7%, while the averages of fragmented and missing BUSCOs correspondingly decreased to 0.7% and 4.6%, respectively. In contrast, the averages of complete, fragmented, and missing BUSCOs of the NextPolish-polished assemblies plateaued after the first round of polishing, which were 94.7%, 0.6%, and 4.6%, respectively. Only after one round of polishing, the complete, fragmented, and missing BUSCOs of the NextPolish-polished assemblies were not significantly different ( P > 0.05) from those of the reference genomes. In contrast, three rounds of Pilon polishing were needed to achieve complete, fragmented, and missing BUSCOs similar ( P > 0.05) to those of the reference genomes. After three rounds of polishing, no significant differences ( P > 0.05) were observed in complete, fragmented, and missing BUSCOs between the Pilon- and NextPolish-polished assemblies.
The draft assemblies of real reads had an average SNP number of 725 SNPs per one million bp of the reference genome, while it was decreased to 25 SNPs per one million bp of the reference genome after one round of Pilon and NextPolish polishing (Table S14). However, two additional rounds of polishing did not correct more SNPs in the assemblies, suggesting that Pilon and NextPolish had removed most residual sequence errors during the first round of polishing. After three rounds of polishing, no significant differences ( P > 0.05) were found in the number of SNPs between the Pilon- and NextPolish-polished assemblies. One round of Pilon and NextPolish polishing increased the averages of OrthoANIu values from 99.25% to 99.86% and 99.88%, respectively (Table S16). Two additional rounds of Pilon and NextPolish polishing only slightly increased the averages of OrthoANIu values to 99.88% and 99.89%, respectively. The OrthoANIu values of the Pilon- and NextPolish-polished assemblies were similar ( P > 0.05) after three rounds of polishing.
As predicted based on the PlasmidFinder database, the draft and polished assemblies of Bacillus anthracis Ames Ancestor and Staphylococcus aureus NCTC 8325 with simulated reads showed plasmid profiles that were congruent with the reference genomes (Table S17). The draft assemblies of E. coli O157:H7 Sakai, S. Typhimurium LT2, and C. sakazakii ATCC 29544 with simulated reads did not contain any plasmids, which were inconsistent with the reference genomes. It is worth noting that their Pilon- and NextPolish-polished assemblies also failed to recover the plasmids that were identified in the reference genomes, irrespective of how many rounds of polishing were performed, which could be attributed to the polishing algorithms of Pilon and NextPolish. In contrast, these plasmids were present in the SPAdes assemblies of Illumina short reads. Therefore, continued improvements to polishing algorithms are warranted in order to further improve the plasmid identification of the polished Oxford Nanopore long-read assemblies. Both the draft and polished assemblies of S. Bareilly CFSAN000189 with real reads contained IncFII(S) that was present in the reference genome (Table S18). The plasmid, IncB/O/K/Z, was absent in the draft assembly of E. coli O26:H11 CFSAN027343, as well as its Pilon-polished assembly after one round of polishing. Noticeably, the Pilon-polished assembly contained IncB/O/K/Z after two rounds of polishing, whereas this plasmid was identified in the NextPolish-polished assembly only after a single round of polishing. The draft assembly of S. aureus CFSAN007894 with real reads carried both rep7 and rep20, while after one round of Pilon and NextPolish polishing, only rep20 was detected in its polished assemblies, which was in agreement with the reference genome.
We found that both polishing strategies improved the genome completeness and accuracy of the Oxford Nanopore long-read assemblies of bacterial pathogens, due to the corrections of sequence errors [ 30 ]. This finding highlights the importance of Illumina short reads in improving the genome completeness and accuracy. Goldstein et al. [ 12 ] also found that the Pilon-polished Oxford Nanopore long-read assemblies of Aeromonas , Flavobacterium , and Pseudonocardia strains were as accurate as their Illumina short-read assemblies, suggesting that polishing is an effective strategy to generate accurate bacterial assemblies. Our assessment of assembly quality demonstrates that one round of NextPolish polishing was sufficient to generate high-quality assemblies of bacterial pathogens, whereas two or three rounds of Pilon polishing were needed in most cases to achieve assemblies with equivalent level of genome completeness and accuracy. Overall, NextPolish was superior in improving the genome completeness and accuracy of bacterial pathogens relative to Pilon, and was tolerant of both simulated and real reads.
ARGs There are many nucleic acid-based approaches currently in use for rapid AMR prediction (e.g. multiplex real-time PCR) [ 41 ], which can detect specific ARGs in bacterial pathogens without culture but are not capable of covering all ARGs potentially present or revealing their genomic architectures. The major barriers to the adoption of Illumina sequencing for routine use stem from the technological limitation that the highly fragmented assemblies of Illumina short reads can only identify the presence of ARGs instead of their complete genomic architectures [ 40 ]. Oxford Nanopore sequencing has been used to identify mobile genetic elements on which ARGs are located and characterize the combination of ARGs co-located on the same mobile genetic element [ 14 , 37 ], though this technology produces a high error rate. A combination of Illumina short reads and Oxford Nanopore long reads may provide both contiguity and accuracy, which can contribute to a better understanding of the locations of ARGs and the routine AMR predictions of antimicrobial-resistant bacterial pathogens. Lemon et al. [ 26 ] reported that the Pilon-polished Oxford Nanopore assemblies of extended-spectrum β -lactamase (ESBL)-producing E. coli and K. pneumoniae allowed for the accurate detection of ARGs. González-Escalona et al. [ 13 ] found a plasmid of 73 kb that carried multiple ARGs in an E. coli O26:H11 strain, as predicted based on the Pilon-polished Oxford Nanopore long-read assembly. Tan et al. [ 42 ] successfully identified ARGs in the Pilon-polished Oxford Nanopore long-read assemblies of 10 Streptococcus suis strains.
In the present study, we compared the AMR genotypes of bacterial pathogens, as predicted based on the draft and polished assemblies. The draft assemblies of the five genotypically antimicrobial-resistant strains with simulated reads displayed genotypes consistent with their corresponding reference genomes ( Table 5 ). Pilon and NextPolish did not change their AMR genotypes. Our results show that the draft assemblies of simulated reads were not able to indicate whether these ARGs were located on the chromosome or plasmid(s) due to incomplete genomes, even after three rounds of Pilon and NextPolish polishing.
Among the six genotypically antimicrobial-resistant strains with real reads ( Table 6 ), the draft and polished assemblies of Klebsiella variicola CFSAN086180, C. jejuni CFSAN032806, and C. coli CFSAN032805 had genotypes consistent with their corresponding reference genomes. As predicted based on the draft and polished assemblies, C. coli CFSAN032805 had one ARG ( blaOXA-61 ) located on the chromosome and three ARGs [ aph(2″)-Ig , aph(3′)-III , and tet(O) ] co-located on a single plasmid, which was in agreement with the reference genome. However, as expected from the fragmented assemblies, both the draft and polished assemblies of K. variicola CFSAN086180 and C. jejuni CFSAN032806 failed to indicate the locations of ARGs. Three ARGs, mph(C) , msr(A) , and tet(K) , were identified in the draft assembly of S. aureus CFSAN007894, which was inconsistent with the reference genome that carried blaZ . Noticeably, Pilon and NextPolish failed to improve the draft assembly of S. aureus CFSAN007894 to achieve an accurate genotype consistent with the reference genome. The reference genome indicates that blaZ was located on a plasmid, while mph(C) , msr(A) , and tet(K) were identified on a different plasmid found in the draft and polished assemblies. The reference genomes of both K. pneumoniae CFSAN086181 and C. braakii CFSAN086182 carried ARG(s) on the chromosome. Most importantly, the draft assembly of K. pneumoniae CFSAN086181 did not harbor any ARGs, whereas one round of Pilon and NextPolish polishing resulted in a genotype consistent with the reference genome, highlighting the merit of polishing with Illumina short reads for AMR prediction. The draft assembly of C. braakii CFSAN086182 harbored fosA6 , while the only ARG present in the reference genome was blaCMY-83 . Interestingly, both fosA6 and blaCMY- 83 were detected in the polished assemblies after one round of Pilon and NextPolish polishing. Two additional rounds of polishing did not change the AMR genotype, as predicted based on the Pilon- and NextPolish-polished assemblies.
According to our assessment of assembly quality, while it is possible to assemble Oxford Nanopore long reads alone into complete genomes, doing so would compromise the genome accuracy, which could lead to incorrect AMR prediction. Improvements to library preparation and basecalling for Oxford Nanopore sequencing, as well as long-read-only assembly algorithms, may mitigate this limitation. Moreover, since assembly contiguity is important for comprehensive AMR analysis, polishing algorithms should also be greatly improved to enable more effective gap closure for incomplete genomes.
Virulence genes WGS provides ample information to enable routine virulence gene profiling of bacterial pathogens, though it is still challenging to extract the most appropriate virulence genes of great interest from a large amount of sequence data. Therefore, to facilitate the use of WGS data for diagnostic and outbreak surveillance purposes, a genome assembly should be accurate enough to contain all relevant virulence gene information. Utilizing Pilon to polish the Oxford Nanopore long-read assemblies, González-Escalona et al. [ 13 ] successfully identified virulence genes on the chromosomes of three E. coli O26:H11 strains and also found virulence plasmids in two of these strains. Taylor et al. [ 43 ] used the same polishing strategy to detect virulence genes in the Oxford Nanopore long-read assembly of an E. coli O157:H7 strain.
In our study, we found that the numbers of virulence genes identified in the draft and polished assemblies of each strain with simulated reads were similar ( P > 0.05) to the reference genome (Table S19). The numbers of virulence genes of the draft assemblies of real reads were significantly lower ( P < 0.05) than those of the reference genomes (Table S20), while only one round of Pilon and NextPolish polishing was need to achieve numbers of virulence genes similar ( P > 0.05) to those of the reference genomes. After three rounds of polishing, no significant differences ( P > 0.05) in the number of virulence genes were observed between the Pilon- and NextPolish-polished assemblies. One notable case existed with the draft assembly of E. coli O26:H11 CFSAN027343 where the assembly of real reads carried 98 virulence genes, whereas 115 virulence genes were present in the reference genome. It is noteworthy that both Pilon and NextPolish failed to improve the assembly of this strain to achieve numbers of virulence genes similar to the reference genome, demonstrating a limitation of polishing for improving the identifications of virulence genes in some cases. Interestingly, 13 of the 17 missing genes, including fes , fepA , fepB , fepC , fepD , fepG , entA , entB , entC , entD , entE , entF , and entS , are close together on the chromosome of the reference genome, which are located within a genomic region of 19,036 bp (4,798,869–4,817,905 bp). Two missing genes, toxB (1–6660 bp) and espM2 (129–717 bp), are observed to be overlapping genes, while ompA (5,261,364–5,262,404 bp) and espW (5,687,319–5,688,377 bp) are more disjunct from other missing genes. In contrast, these genes were identified in the SPAdes assemblies of Illumina short reads. Therefore, polishing algorithms should be improved to achieve an accurate virulence gene profiling of the polished Oxford Nanopore long-read assemblies.
MLST Outbreak investigations of infectious diseases requires the direct comparison of pathogen isolates obtained from different sources to track the origin and determine the transmission mode. With a global epidemiology perspective, [ 56 ] proposed the database-driven MLST to exploit the unambiguous nature and electronic portability of nucleotide sequence data of bacterial pathogens. MLST has been proved useful in characterizing and monitoring disease-causing and antimicrobial-resistant lineages of bacteria [ 4 ]. It is recommended that a major contributing factor of accurate MLST should be the quality of genome assemblies [ 29 ]. Sheppard et al. [ 38 ] emphasized that multiple contigs with relatively short lengths of Illumina short-read assemblies as a potential limitation to MLST. They indicated that this technical issue could be resolved by the development of improved sequencing technologies leading to longer read lengths. Tan et al. [ 42 ] reported that the Pilon-polished Oxford Nanopore long-read assemblies of 10 S. suis strains could be accurately typed for MLST. Nonetheless, a polishing strategy which permits the acquisition of high-quality assemblies for accurate MLST remains to be justified by comparing different polishing tools.
Accordingly, we evaluated if Pilon and NextPolish could improve the Oxford Nanopore long-read assemblies of bacterial pathogens for accurate MLST. For bacterial strains with simulated reads, highly consistent positive MLST results were observed between the draft and polished assemblies. The only case where MLST results differed between the reference genome and draft assembly was that the draft assembly of Clostridium botulinum CDC_1632 was not accurately typed. After one round of polishing, the NextPolish-polished assembly of C. botulinum CDC_1632 showed a positive MLST result, while its Pilon-polished assembly was still not accurately typed. Positive MLST result for C. botulinum CDC_1632 was achieved only after two rounds of Pilon polishing.
When real reads of bacterial pathogens were tested, the draft assemblies showed positive MLST results, with only two exceptions that negative MLST results of E. coli O26:H11 CFSAN027343 and Enterobacter cancerogenus CFSAN086183 were found. After one round of polishing, their Pilon-polished assemblies still showed negative MLST results, whereas positive MLST results were obtained in their NextPolish-polished assemblies. Similar to what we observed for C. botulinum CDC_1632 with simulated reads, these two bacterial strains were accurately typed only when the second round of Pilon polishing was completed.
Hence, NextPolish can enable more accurate MLST of bacterial pathogens within one round of polishing compared to Pilon, irrespective of whether the assembly is generated using simulated or real reads.
Whole- and core-genome phylogeny Recent research offers great promise in the use of the polished Oxford Nanopore long-read assemblies for building phylogenetic trees of bacterial pathogens such as E. coli O26:H11 and Neisseria gonorrhoeae , Paracoccus yeei , and Vibrio parahaemolyticus [ 10 , 13 , 25 , 57 ]. Taking into account the fact that genome accuracy is improved by both polishing strategies as noted above, one can anticipate that discrimination among strains in phylogenetic inference should be enhanced by using the polished Oxford Nanopore long-read assemblies [ 26 ]. In the present study, the Pilon- and NextPolish-assemblies were compared with the reference genomes in the phylogenetic analyses of bacterial pathogens. High consistency in phylogenetic tree topology was observed between the reference genomes and draft assemblies for whole- (Fig. S1 and S2) and core-genome (Fig. S3 and S4) phylogeny using both simulated and real reads. The draft assembly of each strain produced a phylogenetic tree topology where the polished assemblies always clustered together with the reference genome. We thus demonstrate the potential of the draft assembly generated using the long-read-only assembly pipeline of Unicycler for rapid, accurate phylogenetic inference, as revealed by the congruent phylogenetic topology between the reference genome and draft assembly. Still, care should be taken to interpret these results. In the context of clinical lab implementation, we do not suggest here that phylogenetic analysis can as yet be performed solely using the Oxford Nanopore long-read assemblies, especially when Oxford Nanopore long reads are of low quality, though we believe that information from such sequencing will complement Illumina sequencing. It is conceivable that continued improvements to nanopore chemistry, basecalling, and assembly algorithms could further improve the genome accuracy of the Oxford Nanopore long-read assemblies to the point that polishing is not necessary prior to phylogenetic inference. But until then both Illumina short reads and Oxford Nanopore long reads are essential to carry out accurate phylogenetic analyses.
Pan genomes The degree of genome fragmentation in an Illumina short-read assembly can affect conclusions about gene presence and absence beyond just the inability to resolve genomic structures [ 9 ], while high numbers of sequence errors in Oxford Nanopore long reads can prevent accurate genome annotation due to the inaccuracy in gene structure prediction [ 12 ]. Using a combination of short and long reads has emerged as a promising approach to generating both accurate and fully resolved bacterial genomes [ 48 ]. With this approach, Oxford Nanopore long reads provide sufficient information regarding the genome structure, while Illumina short reads facilitate accurate genome annotation.
As shown in Fig. 1 , the pan genome of the reference genome of S. Typhimurium LT2 with simulated reads contained a total of 8352 genes, with 3783 core genes and 4569 accessory genes. It is not surprising that when relying only on Oxford Nanopore long reads with more gene truncation and misplaced start sites [ 6 , 7 ], the pan genome of the draft assembly had a higher number of genes (10,773), with 3479 core genes and 7294 accessory genes. For the pan genomes of the Pilon- and NextPolish-polished assemblies, after one round of polishing, we noticed an increase in the number of core genes to 3759 and 3783, respectively, as well as a decrease in the number of accessory genes to 4658 and 4572, respectively. The pan-genome composition of the NextPolish-polished assembly did not change significantly during further polishing. After the second round of Pilon polishing, the numbers of core and accessory genes of the pan genome of the Pilon-polished assembly became similar to those of the reference genome, which were 3783 and 4585, respectively. However, no further improvements were observed after three rounds of Pilon polishing.
For the pan genome of the reference genome of C. coli CFSAN032805 with real reads, there were a total of 4902 genes, with 1056 core genes and 3846 accessory genes ( Fig. 2 ). In contrast, the pan genome of the draft assembly had 7665 genes, with only 846 core genes and as many as 6819 accessory genes. After one round of NextPolish polishing, the number of core genes increased to 1053, whereas the number of accessory genes dropped drastically to 3859. There were no significant changes in the pan-genome composition after the second and third rounds of NextPolish polishing, again highlighting that one round of NextPolish polishing was sufficient for performing an accurate pan-genome analysis. In contrast, only after two rounds of Pilon polishing could the number of core genes reach up to 1053 and the number of accessory genes decrease to 3859.
Our results demonstrate that NextPolish was more efficient at correcting sequence errors in the Oxford Nanopore long-read assemblies compared to Pilon, regardless of using simulated or real reads. The better performance of NextPolish could be attributed to its superior error correction process where Illumina short reads can effectively ameliorate the deficiencies of Oxford Nanopore long reads with sequence errors that introduce truncated genes [ 12 ]. Our finding is supported by Hu et al. [ 18 ] who developed NextPolish and demonstrated that NextPolish can fix truncated genes more often than Pilon.
Comparison between of Pilon and NextPolish The run times of using Pilon and NextPoilish to polish the Oxford Nanopore long-read assemblies of bacterial pathogens were similar (<5 min). However, Hu et al. [ 18 ] reported that when the assemblies of eukaryotes with larger genome sizes such as Arabidopsis thaliana and Homo sapiens were polished, NextPolish completed the polishing process ~10 times faster than Pilon. To ensure a fair comparison between Pilon and NextPolish, we ran three iterations with both polishing strategies on each assembly and then compared the outcomes for various genomic analyses. A typical Pilon polishing process usually requires more than two rounds of error corrections for bacterial genomes [ 31 , 35 , 55 ]. Similarly, Hu et al. [ 18 ] who developed NextPolish also demonstrated that multiple rounds of Pilon polishing are needed, while NextPolish does not require extra iterations. As also demonstrated by our study, to achieve accurate genomic analyses, Pilon was not able to correct the errors in the long-read assemblies within one round of polishing, whereas NextPolish can accomplish the error corrections in a single round of polishing without the requirement of extra iterations, highlighting the high efficiency of its polishing algorithm that can be most fruitful in the future.
Walker et al. [ 47 ] who developed Pilon reported that the polished assemblies of a Mycobacterium tuberculosis strain and a Streptococcus pneumoniae strain became more contiguous after Pilon polishing. Unlike Pilon, NextPolish does not perform local reassembly and only focuses on the corrections of small-scale errors [ 18 ], which is not able to improve the contiguity. Nevertheless, in our study, we found no improvements to the contiguity of the draft assemblies with incomplete genomes after Pilon polishing. Our observation could be attributed to the fact that Unicycler had already produced the long-read assemblies as contiguous as possible and further polishing with Pilon could not improve the contiguity. In the long-read-only pipeline of Unicycler, Oxford Nanopore long reads are assembled with Miniasm, followed by a consensus step of Racon [ 49 ]. When benchmarking six long-read assembly approaches (Canu, Flye, Miniasm and Racon, Raven, Redbean, and Shasta) on bacterial genomes, Wick and Holt [ 51 ] found that Miniasm and Racon was the only approach that consistently produced perfect contiguity.
Conclusions To improve the assemblies generated from Oxford Nanopore long reads alone, we polished them with Illumina short reads using Pilon and NextPolish to correct sequence errors. We found that both polishing strategies resulted in some benefits for improving genome completeness and accuracy, irrespective of simulated or real reads, though they did not enhance the contiguity. Our results suggest that a single round of NextPolish polishing is sufficient to perform accurate genomic analyses of bacterial pathogens, while at least two rounds of Pilon polishing are required to achieve the same level of accuracy in most cases. For certain genomic analyses such as SNP-based isolate tracking in the epidemiologic setting, assembly at a higher level of accuracy may be required, though our phylogenetic analyses support the conclusion that the use of lower-accuracy Oxford Nanopore long-read assemblies did not substantially affect our ability to call SNPs for phylogenetic inference. Increases in the accuracy of Oxford Nanopore sequencing, combined with advances in assembly and polishing tools, may allow for more accurate genomic analyses. Since polishing tools normally use different algorithms for error corrections, future research is warranted to validate if running combinations of these tools, one after the other and in both orders, could bring about a better polishing outcome. Meanwhile, we acknowledge that as sequencing and basecalling technologies and polishing algorithms advance and mature, defining an optimal polishing approach for genomic analyses of bacterial pathogens should be a continuous process.